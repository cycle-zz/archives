<html>
	<head>
		<title>Branch - API Documentation</title>
		<link HREF="style.css" REL="stylesheet" TYPE="text/css">
	</head>
	<body>
		<div width="100%" height="40px" class="banner">
			Visualizer - API Documentation
		</div>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Visualizer.cpp</h1><a href="Visualizer_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="preprocessor">#include "<a class="code" href="Window_8h.html">Window.h</a>"</span>
00002 <span class="preprocessor">#include "<a class="code" href="Implicits_8h.html">Implicits.h</a>"</span>
00003 <span class="preprocessor">#include "<a class="code" href="Operators_8h.html">Operators.h</a>"</span>
00004 <span class="preprocessor">#include "<a class="code" href="Shading_8h.html">Shading.h</a>"</span>
00005 <span class="preprocessor">#include "<a class="code" href="Volumes_8h.html">Volumes.h</a>"</span>
00006 <span class="preprocessor">#include "<a class="code" href="Visualizer_8h.html">Visualizer.h</a>"</span>
00007 <span class="preprocessor">#include "<a class="code" href="GlutHeaders_8h.html">GlutHeaders.h</a>"</span>
00008 <span class="preprocessor">#include "<a class="code" href="Random_8h.html">Random.h</a>"</span>
00009 <span class="preprocessor">#include "<a class="code" href="Matrix_8h.html">Matrix.h</a>"</span>
00010 
00011 <span class="keyword">using</span> <span class="keyword">namespace </span>dg;
00012 
<a name="l00013"></a><a class="code" href="Visualizer_8cpp.html#a0">00013</a> Visualizer <a class="code" href="Visualizer_8cpp.html#a0">skApp</a>;
00014 
00015 <span class="comment">//******************************************************************************</span>
<a name="l00016"></a><a class="code" href="classdg_1_1Visualizer.html#a0">00016</a> Visualizer::Visualizer( ) :
00017         <a class="code" href="classdg_1_1Window.html">Window</a>("<a class="code" href="classdg_1_1Visualizer.html">Visualizer</a>", 0, 0, 300, 300, <a class="code" href="classdg_1_1Color.html">Color</a>(0.1f, 0.1f, 0.1f, 1.0f)),
00018         m_uiFuncIndex(3), m_eVisMode(VM_MARCHING_TETRA)
00019 {
00020         <span class="comment">//      EMPTY!</span>
00021 }
00022 <span class="comment">//******************************************************************************</span>
<a name="l00023"></a><a class="code" href="classdg_1_1Visualizer.html#a1">00023</a> Visualizer::~Visualizer()
00024 {
00025         <span class="comment">//      EMPTY!</span>
00026 }
00027 <span class="comment">//******************************************************************************</span>
<a name="l00028"></a><a class="code" href="classdg_1_1Visualizer.html#a2">00028</a> <a class="code" href="namespacedg.html#a9">Bool</a> Visualizer::onStartup()
00029 {
00030         <a class="code" href="classdg_1_1Visualizer.html#n6">m_bShowInfo</a> = <span class="keyword">true</span>;
00031         <a class="code" href="classdg_1_1Visualizer.html#n9">m_bShowBounds</a> = <span class="keyword">true</span>;
00032 
00033         <a class="code" href="classdg_1_1Visualizer.html#n14">m_bRayTraced</a> = <span class="keyword">false</span>;
00034         <a class="code" href="classdg_1_1Visualizer.html#n15">m_bHyperTraced</a> = <span class="keyword">false</span>;
00035         <a class="code" href="classdg_1_1Visualizer.html#n16">m_bPolygonized</a> = <span class="keyword">false</span>;
00036         <a class="code" href="classdg_1_1Visualizer.html#n7">m_bUpdate</a> = <span class="keyword">true</span>;
00037         <a class="code" href="classdg_1_1Visualizer.html#n8">m_bRotate</a> = <span class="keyword">false</span>;
00038 
00039         <a class="code" href="classdg_1_1Visualizer.html#n19">m_iSpinX</a> = 0;
00040         <a class="code" href="classdg_1_1Visualizer.html#n20">m_iSpinY</a> = 0;
00041 
00042         <a class="code" href="classdg_1_1Visualizer.html#n21">m_iOrigX</a> = 0;
00043         <a class="code" href="classdg_1_1Visualizer.html#n22">m_iOrigY</a> = 0;
00044 
00045         <a class="code" href="classdg_1_1Visualizer.html#n23">m_iCellCount</a> = 20;
00046 
00047         <a class="code" href="classdg_1_1Visualizer.html#n24">m_fScale</a> = 5;
00048         <a class="code" href="classdg_1_1Visualizer.html#n25">m_fIsoLevel</a> = 0.01;
00049         <a class="code" href="classdg_1_1Visualizer.html#n27">m_fTime</a> = 0.0;
00050 
00051         <a class="code" href="classdg_1_1Visualizer.html#n29">m_fTransparency</a> = 0.5;
00052         <a class="code" href="classdg_1_1Visualizer.html#n30">m_fOffsetX</a> = -0.5;
00053         <a class="code" href="classdg_1_1Visualizer.html#n31">m_fOffsetY</a> = -0.5;
00054         <a class="code" href="classdg_1_1Visualizer.html#n32">m_fOffsetZ</a> = -0.5;
00055 
00056         <a class="code" href="classdg_1_1Visualizer.html#n33">m_fCameraX</a> = 0;
00057         <a class="code" href="classdg_1_1Visualizer.html#n34">m_fCameraY</a> = 0;
00058         <a class="code" href="classdg_1_1Visualizer.html#n35">m_fCameraZ</a> = 0;
00059 
00060         <a class="code" href="classdg_1_1Visualizer.html#n10">m_bSpin</a> = <span class="keyword">true</span>;
00061         <a class="code" href="classdg_1_1Visualizer.html#n11">m_bMove</a> = <span class="keyword">true</span>;
00062         <a class="code" href="classdg_1_1Visualizer.html#n12">m_bLight</a> = <span class="keyword">true</span>;
00063         <a class="code" href="classdg_1_1Visualizer.html#n18">m_bFadeOut</a> = <span class="keyword">true</span>;
00064         <a class="code" href="classdg_1_1Visualizer.html#n17">m_bKeepInView</a> = <span class="keyword">true</span>;
00065         <a class="code" href="classdg_1_1Visualizer.html#n5">m_bUsePerspective</a> = <span class="keyword">false</span>;
00066 
00067         <a class="code" href="classdg_1_1Visualizer.html#n51">m_uiFuncIndex</a> = 3;
00068         <a class="code" href="classdg_1_1Visualizer.html#n52">m_aucFuncName</a> = ImplicitFunc[ <a class="code" href="classdg_1_1Visualizer.html#n51">m_uiFuncIndex</a> ].name;
00069         <a class="code" href="classdg_1_1Visualizer.html#n53">m_pvFunction</a> = ImplicitFunc[ <a class="code" href="classdg_1_1Visualizer.html#n51">m_uiFuncIndex</a> ].op;
00070 
00071         <a class="code" href="classdg_1_1Visualizer.html#n42">m_ePolyMode</a> = GL_FILL;
00072         <a class="code" href="classdg_1_1Visualizer.html#n28">m_eMarchMode</a> = Polygonizer::MM_CUBES;
00073 
00074         <a class="code" href="classdg_1_1Visualizer.html#n45">m_kRayTracer</a>.<a class="code" href="classdg_1_1RayTracer.html#a4">setFunction</a>( <a class="code" href="classdg_1_1Visualizer.html#n53">m_pvFunction</a> );
00075         <a class="code" href="classdg_1_1Visualizer.html#n45">m_kRayTracer</a>.<a class="code" href="classdg_1_1RayTracer.html#a2">setCamera</a>( &amp;<a class="code" href="classdg_1_1Visualizer.html#n46">m_kRayTracerCam</a> );
00076         <a class="code" href="classdg_1_1Visualizer.html#n45">m_kRayTracer</a>.<a class="code" href="classdg_1_1RayTracer.html#a6">setLightDirection</a>( <a class="code" href="classdg_1_1Visualizer.html#n46">m_kRayTracerCam</a>.<a class="code" href="classdg_1_1Camera.html#a5">getDirection</a>() );
00077 
00078         <a class="code" href="classdg_1_1Visualizer.html#n48">m_kHyper</a>.<a class="code" href="classdg_1_1Hypertexture.html#a2">setDensityFunction</a>( <a class="code" href="classdg_1_1Visualizer.html#n53">m_pvFunction</a> );
00079         <a class="code" href="classdg_1_1Visualizer.html#n48">m_kHyper</a>.<a class="code" href="classdg_1_1Hypertexture.html#a7">setCamera</a>( &amp;<a class="code" href="classdg_1_1Visualizer.html#n49">m_kHyperCam</a> );
00080         <a class="code" href="classdg_1_1Visualizer.html#n48">m_kHyper</a>.<a class="code" href="classdg_1_1Hypertexture.html#a10">setLightDirection</a>( <a class="code" href="classdg_1_1Visualizer.html#n49">m_kHyperCam</a>.<a class="code" href="classdg_1_1Camera.html#a5">getDirection</a>() );
00081 
00082         <span class="keywordflow">return</span> <span class="keyword">true</span>;
00083 }
00084 <span class="comment">//******************************************************************************</span>
<a name="l00085"></a><a class="code" href="classdg_1_1Visualizer.html#a3">00085</a> <a class="code" href="namespacedg.html#a9">Bool</a> Visualizer::onInitialize()
00086 {
00087         <a class="code" href="classdg_1_1Visualizer.html#b5">setBackground</a>();
00088         <a class="code" href="classdg_1_1Visualizer.html#b6">setLights</a>();
00089         <a class="code" href="classdg_1_1Visualizer.html#b7">setMaterials</a>();
00090 
00091         <a class="code" href="classdg_1_1Visualizer.html#b0">setupPolygonizer</a>();
00092 
00093         <a class="code" href="classdg_1_1Visualizer.html#a4">onReshape</a>( <a class="code" href="classdg_1_1Window.html#a27">width</a>(), <a class="code" href="classdg_1_1Window.html#a28">height</a>() );
00094 
00095         <span class="keywordflow">return</span> <span class="keyword">true</span>;
00096 }
00097 <span class="comment">//******************************************************************************</span>
<a name="l00098"></a><a class="code" href="classdg_1_1Visualizer.html#a4">00098</a> <span class="keywordtype">void</span> Visualizer::onReshape( <a class="code" href="namespacedg.html#a14">Int</a> iWidth, <a class="code" href="namespacedg.html#a14">Int</a> iHeight )
00099 {
00100         Window::onReshape(iWidth, iHeight);
00101 
00102         <a class="code" href="classdg_1_1Visualizer.html#b4">setupFrustum</a>( iWidth, iHeight, <a class="code" href="classdg_1_1Visualizer.html#n5">m_bUsePerspective</a> );
00103         glViewport( 0, 0, iWidth, iHeight );
00104         glMatrixMode(GL_PROJECTION);
00105         glLoadIdentity();
00106 
00107         <span class="keywordflow">if</span>( m_bUsePerspective )
00108         {
00109                 glFrustum(
00110                         <a class="code" href="classdg_1_1Visualizer.html#n36">m_fFrustumLeft</a>, <a class="code" href="classdg_1_1Visualizer.html#n37">m_fFrustumRight</a>,
00111                         <a class="code" href="classdg_1_1Visualizer.html#n38">m_fFrustumBottom</a>, <a class="code" href="classdg_1_1Visualizer.html#n39">m_fFrustumTop</a>,
00112                         <a class="code" href="classdg_1_1Visualizer.html#n40">m_fFrustumNear</a>, <a class="code" href="classdg_1_1Visualizer.html#n41">m_fFrustumFar</a>);
00113         }
00114         <span class="keywordflow">else</span>
00115         {
00116                 glOrtho(
00117                         <a class="code" href="classdg_1_1Visualizer.html#n36">m_fFrustumLeft</a>, <a class="code" href="classdg_1_1Visualizer.html#n37">m_fFrustumRight</a>,
00118                         <a class="code" href="classdg_1_1Visualizer.html#n38">m_fFrustumBottom</a>, <a class="code" href="classdg_1_1Visualizer.html#n39">m_fFrustumTop</a>,
00119                         <a class="code" href="classdg_1_1Visualizer.html#n38">m_fFrustumBottom</a>, <a class="code" href="classdg_1_1Visualizer.html#n41">m_fFrustumFar</a>);
00120         }
00121 
00122         glMatrixMode( GL_MODELVIEW );
00123 }
00124 <span class="comment">//******************************************************************************</span>
<a name="l00125"></a><a class="code" href="classdg_1_1Visualizer.html#a5">00125</a> <span class="keywordtype">void</span> Visualizer::onDisplay()
00126 {
00127         glClear( GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT );
00128 
00129         <span class="keywordflow">if</span> (m_bMove)
00130         {
00131                 <a class="code" href="classdg_1_1Visualizer.html#n27">m_fTime</a> += 0.025;
00132                 <a class="code" href="classdg_1_1Visualizer.html#b11">update</a>(<a class="code" href="classdg_1_1Visualizer.html#n27">m_fTime</a>);
00133                 <a class="code" href="classdg_1_1Visualizer.html#n7">m_bUpdate</a> = <span class="keyword">true</span>;
00134                 <span class="comment">//m_bPolygonized = false;</span>
00135         }
00136 
00137         <span class="keywordflow">if</span>(<a class="code" href="classdg_1_1Visualizer.html#n54">m_eVisMode</a> == <a class="code" href="classdg_1_1Visualizer.html#s5s0">VM_MARCHING_CUBES</a> || <a class="code" href="classdg_1_1Visualizer.html#n54">m_eVisMode</a> == <a class="code" href="classdg_1_1Visualizer.html#s5s1">VM_MARCHING_TETRA</a>)
00138                 <a class="code" href="classdg_1_1Visualizer.html#a12">drawPolygons</a>();
00139         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classdg_1_1Visualizer.html#n54">m_eVisMode</a> == <a class="code" href="classdg_1_1Visualizer.html#s5s2">VM_RAYTRACE</a>)
00140                 <a class="code" href="classdg_1_1Visualizer.html#a13">drawRaytraced</a>();
00141         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classdg_1_1Visualizer.html#n54">m_eVisMode</a> == <a class="code" href="classdg_1_1Visualizer.html#s5s3">VM_HYPERTEXTURE</a>)
00142                 <a class="code" href="classdg_1_1Visualizer.html#a14">drawHypertexture</a>();
00143 
00144         <span class="keywordflow">if</span>(m_bShowInfo)
00145                 <a class="code" href="classdg_1_1Visualizer.html#a11">drawText</a>();
00146 
00147         <a class="code" href="classdg_1_1Window.html#a9">swapBuffers</a>();
00148         <a class="code" href="classdg_1_1Window.html#a22">updateClicks</a>();
00149 }
00150 <span class="comment">//******************************************************************************</span>
<a name="l00151"></a><a class="code" href="classdg_1_1Visualizer.html#a13">00151</a> <span class="keywordtype">void</span> Visualizer::drawRaytraced()
00152 {
00153         <span class="comment">// if scene was already rendered, just redraw it and return</span>
00154         <span class="keywordflow">if</span>(m_bRayTraced)
00155         {
00156                 <a class="code" href="classdg_1_1Window.html#a18">drawImage</a>( <a class="code" href="classdg_1_1Visualizer.html#n47">m_kRayTracerImage</a>.<a class="code" href="classdg_1_1Image.html#a14">pixels</a>(), 0, 0,
00157                                    <a class="code" href="classdg_1_1Visualizer.html#n47">m_kRayTracerImage</a>.<a class="code" href="classdg_1_1Image.html#a8">width</a>(), <a class="code" href="classdg_1_1Visualizer.html#n47">m_kRayTracerImage</a>.<a class="code" href="classdg_1_1Image.html#a9">height</a>(), <span class="keyword">true</span> );
00158                 <span class="keywordflow">return</span>;
00159         }
00160 
00161         <a class="code" href="classdg_1_1Visualizer.html#n13">m_bRendering</a> = <span class="keyword">true</span>;
00162         <span class="keywordflow">if</span>(m_bShowInfo)
00163         {
00164                 <a class="code" href="classdg_1_1Visualizer.html#a11">drawText</a>();
00165                 <a class="code" href="classdg_1_1Window.html#a9">swapBuffers</a>();
00166         }
00167 
00168         <span class="comment">// start the timer</span>
00169         <a class="code" href="classdg_1_1Visualizer.html#b8">startCalcTimer</a>();
00170 
00171         <span class="comment">// set the increment based on the image resolution</span>
00172         <a class="code" href="namespacedg.html#a15">UInt</a> uiIncrement = (UInt)( 10 * (1.0 / <a class="code" href="classdg_1_1Visualizer.html#n47">m_kRayTracerImage</a>.<a class="code" href="classdg_1_1Image.html#a9">height</a>()) * 1000 );
00173 
00174         <span class="comment">// render the scene incrementally, periodically updating the screen</span>
00175         <span class="keywordflow">for</span>(<a class="code" href="namespacedg.html#a15">UInt</a> uiLine = 0; uiLine &lt; <a class="code" href="classdg_1_1Visualizer.html#n47">m_kRayTracerImage</a>.<a class="code" href="classdg_1_1Image.html#a9">height</a>(); uiLine+=uiIncrement)
00176         {
00177                 <a class="code" href="classdg_1_1Visualizer.html#n45">m_kRayTracer</a>.<a class="code" href="classdg_1_1RayTracer.html#a32">render</a>(uiLine, uiLine + uiIncrement);
00178 
00179                 <a class="code" href="classdg_1_1Visualizer.html#b9">updateCalcTimer</a>();
00180 
00181                 <a class="code" href="classdg_1_1Visualizer.html#b5">setBackground</a>();
00182 
00183                 <span class="keywordflow">if</span>(uiLine + uiIncrement &lt; <a class="code" href="classdg_1_1Visualizer.html#n47">m_kRayTracerImage</a>.<a class="code" href="classdg_1_1Image.html#a9">height</a>())
00184                         <a class="code" href="classdg_1_1Window.html#a18">drawImage</a>( <a class="code" href="classdg_1_1Visualizer.html#n47">m_kRayTracerImage</a>.<a class="code" href="classdg_1_1Image.html#a14">pixels</a>(), 0, 0,
00185                                            <a class="code" href="classdg_1_1Visualizer.html#n47">m_kRayTracerImage</a>.<a class="code" href="classdg_1_1Image.html#a8">width</a>(), uiLine+uiIncrement, <span class="keyword">true</span> );
00186 
00187                 <span class="keywordflow">if</span>(m_bShowInfo)
00188                         <a class="code" href="classdg_1_1Visualizer.html#a11">drawText</a>();
00189 
00190                 <a class="code" href="classdg_1_1Window.html#a9">swapBuffers</a>();
00191         }
00192 
00193         <span class="comment">// stop the timer</span>
00194         <a class="code" href="classdg_1_1Visualizer.html#b10">stopCalcTimer</a>();
00195 
00196         <span class="comment">// blur and draw the final rendered image with alpha</span>
00197         <span class="comment">//m_kRayTracerImage.blur();</span>
00198         <a class="code" href="classdg_1_1Window.html#a18">drawImage</a>( <a class="code" href="classdg_1_1Visualizer.html#n47">m_kRayTracerImage</a>.<a class="code" href="classdg_1_1Image.html#a14">pixels</a>(), 0, 0,
00199                            <a class="code" href="classdg_1_1Visualizer.html#n47">m_kRayTracerImage</a>.<a class="code" href="classdg_1_1Image.html#a8">width</a>(), <a class="code" href="classdg_1_1Visualizer.html#n47">m_kRayTracerImage</a>.<a class="code" href="classdg_1_1Image.html#a9">height</a>(), <span class="keyword">true</span> );
00200 
00201         <a class="code" href="classdg_1_1Window.html#a9">swapBuffers</a>();
00202 
00203         <span class="comment">// toggle the update flags</span>
00204         <a class="code" href="classdg_1_1Visualizer.html#n7">m_bUpdate</a> = <span class="keyword">false</span>;
00205         <a class="code" href="classdg_1_1Visualizer.html#n14">m_bRayTraced</a> = <span class="keyword">true</span>;
00206         <a class="code" href="classdg_1_1Visualizer.html#n13">m_bRendering</a> = <span class="keyword">false</span>;
00207         <a class="code" href="classdg_1_1Window.html#a8">postRedisplay</a>();
00208 }
00209 <span class="comment">//******************************************************************************</span>
<a name="l00210"></a><a class="code" href="classdg_1_1Visualizer.html#a14">00210</a> <span class="keywordtype">void</span> Visualizer::drawHypertexture()
00211 {
00212         <span class="comment">// if scene was already rendered, just redraw it and return</span>
00213         <span class="keywordflow">if</span>(m_bHyperTraced)
00214         {
00215                 <a class="code" href="classdg_1_1Window.html#a18">drawImage</a>( <a class="code" href="classdg_1_1Visualizer.html#n50">m_kHyperImage</a>.<a class="code" href="classdg_1_1Image.html#a14">pixels</a>(), 0, 0,
00216                                    <a class="code" href="classdg_1_1Visualizer.html#n50">m_kHyperImage</a>.<a class="code" href="classdg_1_1Image.html#a8">width</a>(), <a class="code" href="classdg_1_1Visualizer.html#n50">m_kHyperImage</a>.<a class="code" href="classdg_1_1Image.html#a9">height</a>(), <span class="keyword">true</span> );
00217                 <span class="keywordflow">return</span>;
00218         }
00219 
00220         <a class="code" href="classdg_1_1Visualizer.html#n13">m_bRendering</a> = <span class="keyword">true</span>;
00221         <span class="keywordflow">if</span>(m_bShowInfo)
00222         {
00223                 <a class="code" href="classdg_1_1Visualizer.html#a11">drawText</a>();
00224                 <a class="code" href="classdg_1_1Window.html#a9">swapBuffers</a>();
00225         }
00226 
00227         <span class="comment">// start the timer</span>
00228         <a class="code" href="classdg_1_1Visualizer.html#b8">startCalcTimer</a>();
00229 
00230         <span class="comment">// set the increment based on the image resolution</span>
00231         <a class="code" href="namespacedg.html#a15">UInt</a> uiIncrement = (UInt)( 5 * (1.0 / <a class="code" href="classdg_1_1Visualizer.html#n50">m_kHyperImage</a>.<a class="code" href="classdg_1_1Image.html#a9">height</a>()) * 1000 );
00232 
00233         <span class="comment">// render the scene incrementally, periodically updating the screen</span>
00234         <span class="keywordflow">for</span>(<a class="code" href="namespacedg.html#a15">UInt</a> uiLine = 0; uiLine &lt; <a class="code" href="classdg_1_1Visualizer.html#n50">m_kHyperImage</a>.<a class="code" href="classdg_1_1Image.html#a9">height</a>(); uiLine+=uiIncrement)
00235         {
00236                 <a class="code" href="classdg_1_1Visualizer.html#n48">m_kHyper</a>.<a class="code" href="classdg_1_1Hypertexture.html#a49">render</a>(uiLine, uiLine + uiIncrement);
00237 
00238                 <a class="code" href="classdg_1_1Visualizer.html#b9">updateCalcTimer</a>();
00239 
00240                 <a class="code" href="classdg_1_1Visualizer.html#b5">setBackground</a>();
00241 
00242                 <span class="keywordflow">if</span>(uiLine + uiIncrement &lt; <a class="code" href="classdg_1_1Visualizer.html#n50">m_kHyperImage</a>.<a class="code" href="classdg_1_1Image.html#a9">height</a>())
00243                         <a class="code" href="classdg_1_1Window.html#a18">drawImage</a>( <a class="code" href="classdg_1_1Visualizer.html#n50">m_kHyperImage</a>.<a class="code" href="classdg_1_1Image.html#a14">pixels</a>(), 0, 0,
00244                                            <a class="code" href="classdg_1_1Visualizer.html#n50">m_kHyperImage</a>.<a class="code" href="classdg_1_1Image.html#a8">width</a>(), uiLine+uiIncrement, <span class="keyword">true</span> );
00245 
00246                 <span class="keywordflow">if</span>(m_bShowInfo)
00247                         <a class="code" href="classdg_1_1Visualizer.html#a11">drawText</a>();
00248 
00249                 <a class="code" href="classdg_1_1Window.html#a9">swapBuffers</a>();
00250         }
00251 
00252         <span class="comment">// stop the timer</span>
00253         <a class="code" href="classdg_1_1Visualizer.html#b10">stopCalcTimer</a>();
00254 
00255         <span class="comment">// blur and draw the final rendered image with alpha</span>
00256         <span class="comment">//m_kHyperImage.blur();</span>
00257         <a class="code" href="classdg_1_1Window.html#a18">drawImage</a>( <a class="code" href="classdg_1_1Visualizer.html#n50">m_kHyperImage</a>.<a class="code" href="classdg_1_1Image.html#a14">pixels</a>(), 0, 0,
00258                            <a class="code" href="classdg_1_1Visualizer.html#n50">m_kHyperImage</a>.<a class="code" href="classdg_1_1Image.html#a8">width</a>(), <a class="code" href="classdg_1_1Visualizer.html#n50">m_kHyperImage</a>.<a class="code" href="classdg_1_1Image.html#a9">height</a>(), <span class="keyword">true</span> );
00259 
00260         <a class="code" href="classdg_1_1Window.html#a9">swapBuffers</a>();
00261 
00262         <span class="comment">// toggle the update flags</span>
00263         <a class="code" href="classdg_1_1Visualizer.html#n7">m_bUpdate</a> = <span class="keyword">false</span>;
00264         <a class="code" href="classdg_1_1Visualizer.html#n15">m_bHyperTraced</a> = <span class="keyword">true</span>;
00265         <a class="code" href="classdg_1_1Visualizer.html#n13">m_bRendering</a> = <span class="keyword">false</span>;
00266         <a class="code" href="classdg_1_1Window.html#a8">postRedisplay</a>();
00267 }
00268 <span class="comment">//******************************************************************************</span>
<a name="l00269"></a><a class="code" href="classdg_1_1Visualizer.html#a12">00269</a> <span class="keywordtype">void</span> Visualizer::drawPolygons()
00270 {
00271         <span class="comment">// intialize camera</span>
00272         <a class="code" href="classdg_1_1Visualizer.html#b3">setupCamera</a>( <a class="code" href="classdg_1_1Visualizer.html#n44">m_kPolyCam</a> );
00273 
00274         <span class="comment">// update if necessary</span>
00275         <span class="keywordflow">if</span>(<a class="code" href="classdg_1_1Visualizer.html#n7">m_bUpdate</a> || !<a class="code" href="classdg_1_1Visualizer.html#n16">m_bPolygonized</a>)
00276         {
00277                 <a class="code" href="classdg_1_1Visualizer.html#b8">startCalcTimer</a>();
00278                 <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a24">evaluate</a>(<a class="code" href="classdg_1_1Visualizer.html#n28">m_eMarchMode</a>);
00279                 <a class="code" href="classdg_1_1Visualizer.html#b10">stopCalcTimer</a>();
00280                 <a class="code" href="classdg_1_1Visualizer.html#n7">m_bUpdate</a> = <span class="keyword">false</span>;
00281                 <a class="code" href="classdg_1_1Visualizer.html#n16">m_bPolygonized</a> = <span class="keyword">true</span>;
00282         }
00283 
00284         <span class="comment">// set view matrix</span>
00285         glPushMatrix();
00286 
00287         glMatrixMode(GL_MODELVIEW);
00288         glLoadIdentity();
00289 
00290         <a class="code" href="classdg_1_1Vector.html">Vector</a> kPos = <a class="code" href="classdg_1_1Visualizer.html#n44">m_kPolyCam</a>.<a class="code" href="classdg_1_1Camera.html#a3">getPosition</a>();
00291         <a class="code" href="classdg_1_1Vector.html">Vector</a> kUp = <a class="code" href="classdg_1_1Visualizer.html#n44">m_kPolyCam</a>.<a class="code" href="classdg_1_1Camera.html#a7">getUp</a>();
00292         <a class="code" href="classdg_1_1Vector.html">Vector</a> kLookAt = kPos + <a class="code" href="classdg_1_1Visualizer.html#n44">m_kPolyCam</a>.<a class="code" href="classdg_1_1Camera.html#a5">getDirection</a>();
00293 
00294         gluLookAt(kPos.<a class="code" href="classdg_1_1Vector.html#a2">x</a>(), kPos.<a class="code" href="classdg_1_1Vector.html#a3">y</a>(), kPos.<a class="code" href="classdg_1_1Vector.html#a4">z</a>(),
00295                           kLookAt.<a class="code" href="classdg_1_1Vector.html#a2">x</a>(), kLookAt.<a class="code" href="classdg_1_1Vector.html#a3">y</a>(), kLookAt.<a class="code" href="classdg_1_1Vector.html#a4">z</a>(),
00296                           kUp.<a class="code" href="classdg_1_1Vector.html#a2">x</a>(), kUp.<a class="code" href="classdg_1_1Vector.html#a3">y</a>(), kUp.<a class="code" href="classdg_1_1Vector.html#a4">z</a>());
00297 
00298         glPushMatrix();
00299 
00300         <span class="keywordflow">if</span>(m_bShowBounds)
00301         {
00302                 glPushAttrib(GL_LIGHTING_BIT);
00303                 glDisable(GL_LIGHTING);
00304                 glColor3f(1.0, 1.0, 1.0);
00305                 glutWireCube(1.0);
00306                 glPopAttrib();
00307         }
00308 
00309         glPushMatrix();
00310         glTranslatef( -0.5, -0.5, -0.5);
00311         glBegin(GL_TRIANGLES);
00312 
00313         <a class="code" href="namespacedg.html#a15">UInt</a> uiVertexCount = <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a15">getVertices</a>().size();
00314         <span class="keywordflow">for</span> (<a class="code" href="namespacedg.html#a15">UInt</a> i = 0; i &lt; uiVertexCount; i++)
00315         {
00316                 glNormal3f(     <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a16">getNormals</a>()[i].x(),
00317                                         <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a16">getNormals</a>()[i].y(),
00318                                         <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a16">getNormals</a>()[i].z());
00319 
00320                 <span class="keywordflow">if</span>(!<a class="code" href="classdg_1_1Visualizer.html#n12">m_bLight</a>)
00321                         glColor3f(      <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a17">getColors</a>()[i].r(),
00322                                                 <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a17">getColors</a>()[i].g(),
00323                                                 <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a17">getColors</a>()[i].b());
00324 
00325                 glVertex3f(     <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a15">getVertices</a>()[i].x(),
00326                                         <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a15">getVertices</a>()[i].y(),
00327                                         <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a15">getVertices</a>()[i].z());
00328         }
00329         glEnd();
00330         glPopMatrix();
00331 
00332         glPopMatrix();
00333         glPopMatrix();
00334 }
00335 <span class="comment">//******************************************************************************</span>
<a name="l00336"></a><a class="code" href="classdg_1_1Visualizer.html#a11">00336</a> <span class="keywordtype">void</span> Visualizer::drawText()
00337 {
00338         GLint iMatrixMode;
00339         GLint iVP[4];
00340 
00341         <a class="code" href="namespacedg.html#a14">Int</a> iLine = 0;
00342         <a class="code" href="namespacedg.html#a14">Int</a> iCharSpacing = 3;
00343         <a class="code" href="namespacedg.html#a14">Int</a> iLineSpacing = 13;
00344         <a class="code" href="namespacedg.html#a14">Int</a> iStartOffest = 7;
00345 
00346         <a class="code" href="namespacedg.html#a14">Int</a> iW = <a class="code" href="classdg_1_1Window.html#a27">width</a>();
00347         <a class="code" href="namespacedg.html#a14">Int</a> iH = <a class="code" href="classdg_1_1Window.html#a28">height</a>();
00348 
00349         <a class="code" href="classdg_1_1Color.html">Color</a> kTextColor(1.0, 0.8, 0.0, 1.0);
00350 
00351         <a class="code" href="namespacedg.html#a10">Char</a> acOutString [256] = <span class="stringliteral">""</span>;
00352 
00353         <span class="comment">// disable lighting</span>
00354         glPushAttrib(GL_LIGHTING_BIT);
00355         glDisable(GL_LIGHTING);
00356 
00357         <span class="comment">// save the current viewport</span>
00358         glGetIntegerv(GL_VIEWPORT, iVP);
00359         glViewport(0, 0, iW, iH);
00360 
00361         <span class="comment">// save the current matrixmode</span>
00362         glGetIntegerv(GL_MATRIX_MODE, &amp;iMatrixMode);
00363 
00364         <span class="comment">// clear out the projection matrix</span>
00365         glMatrixMode(GL_PROJECTION);
00366         glPushMatrix();
00367         glLoadIdentity();
00368 
00369         <span class="comment">// clear out the modelview matrix</span>
00370         glMatrixMode(GL_MODELVIEW);
00371         glPushMatrix();
00372         glLoadIdentity();
00373 
00374         <span class="comment">// start outputting from the bottom of the screen, upwards</span>
00375         glScalef(2.0f / iW, -2.0f / iH, 1.0f);
00376         glTranslatef(-iW / 2.0f, -iH / 2.0f, 0.0f);
00377 
00378         <span class="comment">// set the current text color</span>
00379         glColor4f( kTextColor.<a class="code" href="classdg_1_1Color.html#a3">r</a>(), kTextColor.<a class="code" href="classdg_1_1Color.html#a4">g</a>(), kTextColor.<a class="code" href="classdg_1_1Color.html#a5">b</a>(), kTextColor.<a class="code" href="classdg_1_1Color.html#a6">a</a>() );
00380 
00381         <span class="comment">// output a notice if rendering</span>
00382         <span class="keywordflow">if</span>(m_bRendering)
00383         {
00384                 sprintf(acOutString, <span class="stringliteral">"... RENDERING ..."</span>);
00385 
00386                 <a class="code" href="classdg_1_1Window.html#a20">drawString</a>(acOutString, <a class="code" href="classdg_1_1Window.html#a27">width</a>()/2 - strlen(acOutString) * iCharSpacing,
00387                         <a class="code" href="classdg_1_1Window.html#a28">height</a>()/2 - (iLineSpacing), kTextColor);
00388         }
00389 
00390         <span class="keywordflow">if</span>(<a class="code" href="classdg_1_1Visualizer.html#n54">m_eVisMode</a> == <a class="code" href="classdg_1_1Visualizer.html#s5s0">VM_MARCHING_CUBES</a>)
00391         {
00392                 sprintf(acOutString, <span class="stringliteral">"Vis Method [ Marching Cubes ] - Function [ %s ] - Calc Time [ %02u:%02u:%02u.%02u sec ]"</span>,
00393                         <a class="code" href="classdg_1_1Visualizer.html#n52">m_aucFuncName</a>, <a class="code" href="classdg_1_1Visualizer.html#n1">m_uiHours</a>, <a class="code" href="classdg_1_1Visualizer.html#n2">m_uiMinutes</a>, <a class="code" href="classdg_1_1Visualizer.html#n3">m_uiSeconds</a>, <a class="code" href="classdg_1_1Visualizer.html#n4">m_uiMilliSecs</a>);
00394                 <a class="code" href="classdg_1_1Window.html#a20">drawString</a>(acOutString, 10,
00395                         iH - (iLineSpacing * iLine++) - iStartOffest, kTextColor);
00396         }
00397         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classdg_1_1Visualizer.html#n54">m_eVisMode</a> == <a class="code" href="classdg_1_1Visualizer.html#s5s1">VM_MARCHING_TETRA</a>)
00398         {
00399                 sprintf(acOutString, <span class="stringliteral">"Vis Method [ Marching Tetra ] - Function [ %s ] - Calc Time [ %02u:%02u:%02u.%02u sec ]"</span>,
00400                         <a class="code" href="classdg_1_1Visualizer.html#n52">m_aucFuncName</a>, <a class="code" href="classdg_1_1Visualizer.html#n1">m_uiHours</a>, <a class="code" href="classdg_1_1Visualizer.html#n2">m_uiMinutes</a>, <a class="code" href="classdg_1_1Visualizer.html#n3">m_uiSeconds</a>, <a class="code" href="classdg_1_1Visualizer.html#n4">m_uiMilliSecs</a>);
00401                 <a class="code" href="classdg_1_1Window.html#a20">drawString</a>(acOutString, 10,
00402                         iH - (iLineSpacing * iLine++) - iStartOffest, kTextColor);
00403         }
00404         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classdg_1_1Visualizer.html#n54">m_eVisMode</a> == <a class="code" href="classdg_1_1Visualizer.html#s5s2">VM_RAYTRACE</a>)
00405         {
00406                 sprintf(acOutString, <span class="stringliteral">"Vis Method [ Raytraced ] - Function [ %s ] - Calc Time [ %02u:%02u:%02u.%02u sec ]"</span>,
00407                         <a class="code" href="classdg_1_1Visualizer.html#n52">m_aucFuncName</a>, <a class="code" href="classdg_1_1Visualizer.html#n1">m_uiHours</a>, <a class="code" href="classdg_1_1Visualizer.html#n2">m_uiMinutes</a>, <a class="code" href="classdg_1_1Visualizer.html#n3">m_uiSeconds</a>, <a class="code" href="classdg_1_1Visualizer.html#n4">m_uiMilliSecs</a>);
00408                 <a class="code" href="classdg_1_1Window.html#a20">drawString</a>(acOutString, 10,
00409                         iH - (iLineSpacing * iLine++) - iStartOffest, kTextColor);
00410         }
00411         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classdg_1_1Visualizer.html#n54">m_eVisMode</a> == <a class="code" href="classdg_1_1Visualizer.html#s5s3">VM_HYPERTEXTURE</a>)
00412         {
00413                 sprintf(acOutString, <span class="stringliteral">"Vis Method [ Hypertexture ] - Function [ %s ] - Calc Time [ %02u:%02u:%02u.%02u sec ]"</span>,
00414                         <a class="code" href="classdg_1_1Visualizer.html#n52">m_aucFuncName</a>, <a class="code" href="classdg_1_1Visualizer.html#n1">m_uiHours</a>, <a class="code" href="classdg_1_1Visualizer.html#n2">m_uiMinutes</a>, <a class="code" href="classdg_1_1Visualizer.html#n3">m_uiSeconds</a>, <a class="code" href="classdg_1_1Visualizer.html#n4">m_uiMilliSecs</a>);
00415                 <a class="code" href="classdg_1_1Window.html#a20">drawString</a>(acOutString, 10,
00416                         iH - (iLineSpacing * iLine++) - iStartOffest, kTextColor);
00417         }
00418 
00419         <span class="comment">// format the text</span>
00420         sprintf(acOutString, <span class="stringliteral">"IsoLevel [ %0.3f ] - Scale [ %0.3f ] - Offset [ %0.3f %0.3f %0.3f ] - Spin[ %d %d ]"</span>,
00421                 <a class="code" href="classdg_1_1Visualizer.html#n25">m_fIsoLevel</a>, 1.0f/<a class="code" href="classdg_1_1Visualizer.html#n24">m_fScale</a>, <a class="code" href="classdg_1_1Visualizer.html#n30">m_fOffsetX</a>, <a class="code" href="classdg_1_1Visualizer.html#n31">m_fOffsetY</a>, <a class="code" href="classdg_1_1Visualizer.html#n32">m_fOffsetZ</a>,
00422                 <a class="code" href="classdg_1_1Visualizer.html#n19">m_iSpinX</a>%360, <a class="code" href="classdg_1_1Visualizer.html#n20">m_iSpinY</a>%360);
00423 
00424         <span class="comment">// draw the text to the screen</span>
00425         <a class="code" href="classdg_1_1Window.html#a20">drawString</a>(acOutString, 10,
00426                 iH - (iLineSpacing * iLine++) - iStartOffest, kTextColor);
00427 
00428         <span class="comment">// output appropriate text for the current mode</span>
00429         <span class="keywordflow">if</span>(<a class="code" href="classdg_1_1Visualizer.html#n54">m_eVisMode</a> == <a class="code" href="classdg_1_1Visualizer.html#s5s0">VM_MARCHING_CUBES</a> || <a class="code" href="classdg_1_1Visualizer.html#n54">m_eVisMode</a> == <a class="code" href="classdg_1_1Visualizer.html#s5s1">VM_MARCHING_TETRA</a> )
00430         {
00431                 sprintf(acOutString, <span class="stringliteral">"Cells [ %d x %d x %d ] - Polygons [ %d ] - Vertices [ %d ]"</span>,
00432                         <a class="code" href="classdg_1_1Visualizer.html#n23">m_iCellCount</a>, <a class="code" href="classdg_1_1Visualizer.html#n23">m_iCellCount</a>, <a class="code" href="classdg_1_1Visualizer.html#n23">m_iCellCount</a>,
00433                         <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a15">getVertices</a>().size()/3,
00434                         <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a15">getVertices</a>().size());
00435 
00436                 <a class="code" href="classdg_1_1Window.html#a20">drawString</a>(acOutString, 10,
00437                         iH - (iLineSpacing * iLine++) - iStartOffest, kTextColor);
00438         }
00439         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classdg_1_1Visualizer.html#n54">m_eVisMode</a> == <a class="code" href="classdg_1_1Visualizer.html#s5s2">VM_RAYTRACE</a>)
00440         {
00441                 sprintf(acOutString, <span class="stringliteral">"Sample Rays [ %d ] - Ray Hits [ %d ] - Resolution [ %d x %d ]"</span>,
00442                         (<a class="code" href="namespacedg.html#a15">UInt</a>)(<a class="code" href="classdg_1_1Visualizer.html#n23">m_iCellCount</a> * <a class="code" href="classdg_1_1Visualizer.html#q0">ms_fCellToRayScale</a>), <a class="code" href="classdg_1_1Visualizer.html#n45">m_kRayTracer</a>.<a class="code" href="classdg_1_1RayTracer.html#a17">getRayHits</a>(), iW, iH);
00443 
00444                 <a class="code" href="classdg_1_1Window.html#a20">drawString</a>(acOutString, 10,
00445                         iH - (iLineSpacing * iLine++) - iStartOffest, kTextColor);
00446         }
00447         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classdg_1_1Visualizer.html#n54">m_eVisMode</a> == <a class="code" href="classdg_1_1Visualizer.html#s5s3">VM_HYPERTEXTURE</a>)
00448         {
00449                 sprintf(acOutString, <span class="stringliteral">"Sample Rays [ %d ] - RayHits [ %d ] - Step Size [ %f ] - Resolution [ %d x %d ]"</span>,
00450                         <a class="code" href="classdg_1_1Visualizer.html#n48">m_kHyper</a>.<a class="code" href="classdg_1_1Hypertexture.html#a42">getSamples</a>(), <a class="code" href="classdg_1_1Visualizer.html#n48">m_kHyper</a>.<a class="code" href="classdg_1_1Hypertexture.html#a41">getRayHits</a>(), <a class="code" href="classdg_1_1Visualizer.html#n48">m_kHyper</a>.<a class="code" href="classdg_1_1Hypertexture.html#a37">getStepSize</a>(), iW, iH);
00451 
00452                 <a class="code" href="classdg_1_1Window.html#a20">drawString</a>(acOutString, 10,
00453                         iH - (iLineSpacing * iLine++) - iStartOffest, kTextColor);
00454         }
00455 
00456         <span class="comment">// restore the projection matrix</span>
00457         glPopMatrix();
00458         glMatrixMode(GL_PROJECTION);
00459 
00460         <span class="comment">// restore the previous matrix</span>
00461         glPopMatrix();
00462         glMatrixMode(iMatrixMode);
00463 
00464         <span class="comment">// restor the previous attributes</span>
00465         glPopAttrib();
00466 
00467         <span class="comment">// restore the previous viewport</span>
00468         glViewport(iVP[0], iVP[1], iVP[2], iVP[3]);
00469 }
00470 <span class="comment">//******************************************************************************</span>
<a name="l00471"></a><a class="code" href="classdg_1_1Visualizer.html#a9">00471</a> <span class="keywordtype">void</span> Visualizer::onMouseMotion( <a class="code" href="namespacedg.html#a14">Int</a> iX, <a class="code" href="namespacedg.html#a14">Int</a> iY, <a class="code" href="namespacedg.html#a15">UInt</a> )
00472 {
00473         <span class="keywordflow">if</span>( m_bRotate )
00474         {
00475                 <span class="comment">// accumulate rotation from update deltas (not great, but it works)</span>
00476                 <a class="code" href="classdg_1_1Visualizer.html#n20">m_iSpinY</a> = ( <a class="code" href="classdg_1_1Visualizer.html#n20">m_iSpinY</a> + (iX - <a class="code" href="classdg_1_1Visualizer.html#n21">m_iOrigX</a>) );
00477                 <a class="code" href="classdg_1_1Visualizer.html#n19">m_iSpinX</a> = ( <a class="code" href="classdg_1_1Visualizer.html#n19">m_iSpinX</a> + (iY - <a class="code" href="classdg_1_1Visualizer.html#n22">m_iOrigY</a>) );
00478                 <a class="code" href="classdg_1_1Visualizer.html#n21">m_iOrigX</a> = iX;
00479                 <a class="code" href="classdg_1_1Visualizer.html#n22">m_iOrigY</a> = iY;
00480         }
00481 }
00482 <span class="comment">//******************************************************************************</span>
<a name="l00483"></a><a class="code" href="classdg_1_1Visualizer.html#a10">00483</a> <span class="keywordtype">void</span> Visualizer::onMouseClick( <a class="code" href="namespacedg.html#a14">Int</a> iButton, <a class="code" href="namespacedg.html#a14">Int</a> iState, <a class="code" href="namespacedg.html#a14">Int</a> iX, <a class="code" href="namespacedg.html#a14">Int</a> iY,<a class="code" href="namespacedg.html#a15">UInt</a> uiModifiers)
00484 {
00485         Window::onMouseClick(iButton, iState, iX, iY, uiModifiers);
00486 
00487         <span class="comment">// clear the rotation flag</span>
00488         <a class="code" href="classdg_1_1Visualizer.html#n8">m_bRotate</a> = <span class="keyword">false</span>;
00489         <span class="keywordflow">if</span> ( <a class="code" href="classdg_1_1Window.html#n1">m_bLeftMousePressed</a> || <a class="code" href="classdg_1_1Window.html#n2">m_bRightMousePressed</a> || <a class="code" href="classdg_1_1Window.html#n3">m_bMiddleMousePressed</a> )
00490         {
00491                 <span class="comment">// save the current update position</span>
00492                 <a class="code" href="classdg_1_1Visualizer.html#n21">m_iOrigX</a> = iX;
00493                 <a class="code" href="classdg_1_1Visualizer.html#n22">m_iOrigY</a> = iY;
00494 
00495                 <span class="comment">// toggle the rotation flag</span>
00496                 <a class="code" href="classdg_1_1Visualizer.html#n8">m_bRotate</a> = <span class="keyword">true</span>;
00497 
00498                 <span class="comment">// reset the visulization mode to marching tetra</span>
00499                 <span class="keywordflow">if</span>(<a class="code" href="classdg_1_1Visualizer.html#n54">m_eVisMode</a> == <a class="code" href="classdg_1_1Visualizer.html#s5s2">VM_RAYTRACE</a> || <a class="code" href="classdg_1_1Visualizer.html#n54">m_eVisMode</a> == <a class="code" href="classdg_1_1Visualizer.html#s5s3">VM_HYPERTEXTURE</a>)
00500                         <a class="code" href="classdg_1_1Visualizer.html#n54">m_eVisMode</a> = <a class="code" href="classdg_1_1Visualizer.html#s5s1">VM_MARCHING_TETRA</a>;
00501         }
00502 }
00503 <span class="comment">//******************************************************************************</span>
<a name="l00504"></a><a class="code" href="classdg_1_1Visualizer.html#a7">00504</a> <span class="keywordtype">void</span> Visualizer::onKeyDown( <a class="code" href="namespacedg.html#a11">UChar</a> ucKey, <a class="code" href="namespacedg.html#a14">Int</a>, <a class="code" href="namespacedg.html#a14">Int</a> )
00505 {
00506         <span class="keywordflow">switch</span> (ucKey)
00507         {
00508                 <span class="keywordflow">case</span> <span class="charliteral">'i'</span>:
00509                 {
00510                         <a class="code" href="classdg_1_1Visualizer.html#n6">m_bShowInfo</a> = !<a class="code" href="classdg_1_1Visualizer.html#n6">m_bShowInfo</a>;
00511                         <span class="keywordflow">break</span>;
00512                 }
00513                 <span class="keywordflow">case</span> <span class="charliteral">'b'</span> :
00514                 {
00515                         <a class="code" href="classdg_1_1Visualizer.html#n9">m_bShowBounds</a> = !<a class="code" href="classdg_1_1Visualizer.html#n9">m_bShowBounds</a>;
00516                         <span class="keywordflow">break</span>;
00517                 }
00518                 <span class="keywordflow">case</span> <span class="charliteral">'j'</span> :
00519                 {
00520                         <a class="code" href="classdg_1_1Visualizer.html#n18">m_bFadeOut</a> = !<a class="code" href="classdg_1_1Visualizer.html#n18">m_bFadeOut</a>;
00521                         <span class="keywordflow">break</span>;
00522                 }
00523                 <span class="keywordflow">case</span> <span class="charliteral">'k'</span> :
00524                 {
00525                         <a class="code" href="classdg_1_1Visualizer.html#n17">m_bKeepInView</a> = !<a class="code" href="classdg_1_1Visualizer.html#n17">m_bKeepInView</a>;
00526                         <span class="keywordflow">break</span>;
00527                 }
00528                 <span class="keywordflow">case</span> <span class="charliteral">'+'</span> :
00529                 <span class="keywordflow">case</span> <span class="charliteral">'='</span> :
00530                 {
00531                         ++<a class="code" href="classdg_1_1Visualizer.html#n23">m_iCellCount</a>;
00532                         <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a5">setCellCount</a>( <a class="code" href="classdg_1_1Visualizer.html#n23">m_iCellCount</a> );
00533                         <a class="code" href="classdg_1_1Visualizer.html#b0">setupPolygonizer</a>();
00534                         <span class="keywordflow">break</span>;
00535                 }
00536                 <span class="keywordflow">case</span> <span class="charliteral">'-'</span> :
00537                 {
00538                         <span class="keywordflow">if</span> (<a class="code" href="classdg_1_1Visualizer.html#n23">m_iCellCount</a> &gt; 1)
00539                         {
00540                                 --<a class="code" href="classdg_1_1Visualizer.html#n23">m_iCellCount</a>;
00541                                 <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a5">setCellCount</a>( <a class="code" href="classdg_1_1Visualizer.html#n23">m_iCellCount</a> );
00542                                 <a class="code" href="classdg_1_1Visualizer.html#b0">setupPolygonizer</a>();
00543                         }
00544                         <span class="keywordflow">break</span>;
00545                 }
00546                 <span class="keywordflow">case</span> <span class="charliteral">'e'</span> :
00547                 {
00548                         <a class="code" href="classdg_1_1Visualizer.html#n54">m_eVisMode</a> = <a class="code" href="classdg_1_1Visualizer.html#s5s3">VM_HYPERTEXTURE</a>;
00549                         <a class="code" href="classdg_1_1Visualizer.html#b2">setupHypertexture</a>();
00550                         <span class="keywordflow">break</span>;
00551                 }
00552                 <span class="keywordflow">case</span> <span class="charliteral">'r'</span> :
00553                 {
00554                         <a class="code" href="classdg_1_1Visualizer.html#n54">m_eVisMode</a> = <a class="code" href="classdg_1_1Visualizer.html#s5s2">VM_RAYTRACE</a>;
00555                         <a class="code" href="classdg_1_1Visualizer.html#b1">setupRayTracer</a>();
00556                         <span class="keywordflow">break</span>;
00557                 }
00558                 <span class="keywordflow">case</span> <span class="charliteral">'t'</span> :
00559                 {
00560                         <a class="code" href="classdg_1_1Visualizer.html#n28">m_eMarchMode</a> = Polygonizer::MM_TETRA;
00561                         <a class="code" href="classdg_1_1Visualizer.html#n54">m_eVisMode</a> = <a class="code" href="classdg_1_1Visualizer.html#s5s1">VM_MARCHING_TETRA</a>;
00562                         <a class="code" href="classdg_1_1Visualizer.html#b0">setupPolygonizer</a>();
00563                         <span class="keywordflow">break</span>;
00564                 }
00565                 <span class="keywordflow">case</span> <span class="charliteral">'y'</span> :
00566                 {
00567                         <a class="code" href="classdg_1_1Visualizer.html#n28">m_eMarchMode</a> = Polygonizer::MM_CUBES;
00568                         <a class="code" href="classdg_1_1Visualizer.html#n54">m_eVisMode</a> = <a class="code" href="classdg_1_1Visualizer.html#s5s0">VM_MARCHING_CUBES</a>;
00569                         <a class="code" href="classdg_1_1Visualizer.html#b0">setupPolygonizer</a>();
00570                         <span class="keywordflow">break</span>;
00571                 }
00572                 <span class="keywordflow">case</span> <span class="charliteral">'['</span> :
00573                 {
00574                         <span class="keywordflow">if</span> (<a class="code" href="classdg_1_1Visualizer.html#n24">m_fScale</a> &lt; 100.0)
00575                         {
00576                                 <a class="code" href="classdg_1_1Visualizer.html#n24">m_fScale</a> *= 1.1;
00577                                 <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a11">setScale</a>( <a class="code" href="classdg_1_1Visualizer.html#n24">m_fScale</a> );
00578                                 <a class="code" href="classdg_1_1Visualizer.html#b0">setupPolygonizer</a>();
00579                         }
00580                         <span class="keywordflow">break</span>;
00581                 }
00582                 <span class="keywordflow">case</span> <span class="charliteral">']'</span> :
00583                 {
00584                         <span class="keywordflow">if</span> (<a class="code" href="classdg_1_1Visualizer.html#n24">m_fScale</a> &gt; 0.0001)
00585                         {
00586                                 <a class="code" href="classdg_1_1Visualizer.html#n24">m_fScale</a> /= 1.1;
00587                                 <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a11">setScale</a>( <a class="code" href="classdg_1_1Visualizer.html#n24">m_fScale</a> );
00588                                 <a class="code" href="classdg_1_1Visualizer.html#b0">setupPolygonizer</a>();
00589                         }
00590                         <span class="keywordflow">break</span>;
00591                 }
00592                 <span class="keywordflow">case</span> <span class="charliteral">'n'</span> :
00593                 {
00594                         <span class="keywordflow">if</span> (m_bLight)
00595                                 glDisable(GL_LIGHTING); <span class="comment">//use vertex colors</span>
00596                         <span class="keywordflow">else</span>
00597                                 glEnable(GL_LIGHTING); <span class="comment">//use lit material color</span>
00598 
00599                         <a class="code" href="classdg_1_1Visualizer.html#n12">m_bLight</a> = !<a class="code" href="classdg_1_1Visualizer.html#n12">m_bLight</a>;
00600                         <span class="keywordflow">break</span>;
00601                 }
00602                 <span class="keywordflow">case</span> <span class="charliteral">'l'</span> :
00603                 {
00604                         <span class="keywordflow">if</span> (<a class="code" href="classdg_1_1Visualizer.html#n42">m_ePolyMode</a> == GL_LINE)
00605                                 <a class="code" href="classdg_1_1Visualizer.html#n42">m_ePolyMode</a> = GL_FILL;
00606                         <span class="keywordflow">else</span>
00607                                 <a class="code" href="classdg_1_1Visualizer.html#n42">m_ePolyMode</a> = GL_LINE;
00608                         glPolygonMode(GL_FRONT_AND_BACK, <a class="code" href="classdg_1_1Visualizer.html#n42">m_ePolyMode</a>);
00609                         <span class="keywordflow">break</span>;
00610                 }
00611                 <span class="keywordflow">case</span> <span class="charliteral">'&lt;'</span>:
00612                 {
00613                         <span class="keywordflow">if</span>(<a class="code" href="classdg_1_1Visualizer.html#n29">m_fTransparency</a> &lt; 1.0)
00614                         {
00615                                 <a class="code" href="classdg_1_1Visualizer.html#n29">m_fTransparency</a> *= 1.05;
00616                                 <a class="code" href="classdg_1_1Visualizer.html#b7">setMaterials</a>();
00617                         }
00618                         <span class="keywordflow">break</span>;
00619                 }
00620                 <span class="keywordflow">case</span> <span class="charliteral">'&gt;'</span>:
00621                 {
00622                         <span class="keywordflow">if</span>(<a class="code" href="classdg_1_1Visualizer.html#n29">m_fTransparency</a> &gt; 0.0)
00623                         {
00624                                 <a class="code" href="classdg_1_1Visualizer.html#n29">m_fTransparency</a> /= 1.05;
00625                                 <a class="code" href="classdg_1_1Visualizer.html#b7">setMaterials</a>();
00626                         }
00627                         <span class="keywordflow">break</span>;
00628                 }
00629                 <span class="keywordflow">case</span> <span class="charliteral">'f'</span>:
00630                 {
00631                         <a class="code" href="namespacedg.html#a15">UInt</a> i = <a class="code" href="classdg_1_1Visualizer.html#n51">m_uiFuncIndex</a>;
00632                         <span class="keywordflow">while</span>( i == <a class="code" href="classdg_1_1Visualizer.html#n51">m_uiFuncIndex</a> )
00633                                 <a class="code" href="classdg_1_1Visualizer.html#n51">m_uiFuncIndex</a> = <a class="code" href="namespacedg.html#a167">RandomInt</a>() % ImplicitFuncCount;
00634 
00635                         <a class="code" href="classdg_1_1Visualizer.html#n7">m_bUpdate</a> = <span class="keyword">true</span>;
00636                         <a class="code" href="classdg_1_1Visualizer.html#n14">m_bRayTraced</a> = <span class="keyword">false</span>;
00637                         <a class="code" href="classdg_1_1Visualizer.html#n15">m_bHyperTraced</a> = <span class="keyword">false</span>;
00638                         <a class="code" href="classdg_1_1Visualizer.html#n16">m_bPolygonized</a> = <span class="keyword">false</span>;
00639                         <a class="code" href="classdg_1_1Visualizer.html#b0">setupPolygonizer</a>();
00640                         <span class="keywordflow">break</span>;
00641                 }
00642                 <span class="keywordflow">case</span> <span class="charliteral">'w'</span>:
00643                 {
00644                         <span class="keywordflow">if</span>(<a class="code" href="classdg_1_1Visualizer.html#n35">m_fCameraZ</a> &lt; <a class="code" href="classdg_1_1Visualizer.html#n41">m_fFrustumFar</a>)
00645                                 <a class="code" href="classdg_1_1Visualizer.html#n35">m_fCameraZ</a> += 0.1;
00646                         <span class="keywordflow">break</span>;
00647                 }
00648                 <span class="keywordflow">case</span> <span class="charliteral">'s'</span>:
00649                 {
00650                         <span class="keywordflow">if</span>(<a class="code" href="classdg_1_1Visualizer.html#n35">m_fCameraZ</a> &gt; 0)
00651                                 <a class="code" href="classdg_1_1Visualizer.html#n35">m_fCameraZ</a> -= 0.1;
00652                         <span class="keywordflow">break</span>;
00653                 }
00654                 <span class="keywordflow">case</span> <span class="charliteral">'p'</span>:
00655                 {
00656                         <a class="code" href="classdg_1_1Visualizer.html#n5">m_bUsePerspective</a> = !<a class="code" href="classdg_1_1Visualizer.html#n5">m_bUsePerspective</a>;
00657                         <a class="code" href="classdg_1_1Visualizer.html#a4">onReshape</a>(<a class="code" href="classdg_1_1Window.html#a27">width</a>(),<a class="code" href="classdg_1_1Window.html#a28">height</a>());
00658                         <span class="keywordflow">break</span>;
00659                 }
00660                 <span class="keywordflow">case</span> <span class="charliteral">'m'</span>:
00661                 {
00662                         <a class="code" href="classdg_1_1Visualizer.html#n11">m_bMove</a> = !<a class="code" href="classdg_1_1Visualizer.html#n11">m_bMove</a>;
00663                         <a class="code" href="classdg_1_1Visualizer.html#b0">setupPolygonizer</a>();
00664                         <span class="keywordflow">break</span>;
00665                 }
00666         }
00667 }
00668 <span class="comment">//******************************************************************************</span>
<a name="l00669"></a><a class="code" href="classdg_1_1Visualizer.html#a8">00669</a> <span class="keywordtype">void</span> Visualizer::onSpecialKeyDown( <a class="code" href="namespacedg.html#a14">Int</a> iKey, <a class="code" href="namespacedg.html#a14">Int</a>, <a class="code" href="namespacedg.html#a14">Int</a> )
00670 {
00671         <span class="keywordflow">switch</span> (iKey)
00672         {
00673                 <span class="keywordflow">case</span> GLUT_KEY_PAGE_UP :
00674                         {
00675                                 <span class="keywordflow">if</span> (<a class="code" href="classdg_1_1Visualizer.html#n25">m_fIsoLevel</a> &lt; 10000.0)
00676                                 {
00677                                         <a class="code" href="classdg_1_1Visualizer.html#n25">m_fIsoLevel</a> *= 1.1;
00678                                         <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a7">setIsoLevel</a>( <a class="code" href="classdg_1_1Visualizer.html#n25">m_fIsoLevel</a> );
00679                                         <a class="code" href="classdg_1_1Visualizer.html#b0">setupPolygonizer</a>();
00680                                 }
00681                         }
00682                         <span class="keywordflow">break</span>;
00683                 <span class="keywordflow">case</span> GLUT_KEY_PAGE_DOWN :
00684                         {
00685                                 <span class="keywordflow">if</span> (<a class="code" href="classdg_1_1Visualizer.html#n25">m_fIsoLevel</a> &gt; 0.0)
00686                                 {
00687                                         <a class="code" href="classdg_1_1Visualizer.html#n25">m_fIsoLevel</a> /= 1.1;
00688                                         <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a7">setIsoLevel</a>( <a class="code" href="classdg_1_1Visualizer.html#n25">m_fIsoLevel</a> );
00689                                         <a class="code" href="classdg_1_1Visualizer.html#b0">setupPolygonizer</a>();
00690                                 }
00691                         }
00692                         <span class="keywordflow">break</span>;
00693                 <span class="keywordflow">case</span> GLUT_KEY_HOME :
00694                         {
00695                                 <a class="code" href="classdg_1_1Visualizer.html#n32">m_fOffsetZ</a> += 0.1;
00696                                 <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a9">setOffset</a>( <a class="code" href="classdg_1_1Visualizer.html#n30">m_fOffsetX</a>, <a class="code" href="classdg_1_1Visualizer.html#n31">m_fOffsetY</a>, <a class="code" href="classdg_1_1Visualizer.html#n32">m_fOffsetZ</a> );
00697                                 <a class="code" href="classdg_1_1Visualizer.html#b0">setupPolygonizer</a>();
00698                         }
00699                         <span class="keywordflow">break</span>;
00700                 <span class="keywordflow">case</span> GLUT_KEY_END :
00701                         {
00702                                 <a class="code" href="classdg_1_1Visualizer.html#n32">m_fOffsetZ</a> -= 0.1;
00703                                 <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a9">setOffset</a>( <a class="code" href="classdg_1_1Visualizer.html#n30">m_fOffsetX</a>, <a class="code" href="classdg_1_1Visualizer.html#n31">m_fOffsetY</a>, <a class="code" href="classdg_1_1Visualizer.html#n32">m_fOffsetZ</a> );
00704                                 <a class="code" href="classdg_1_1Visualizer.html#b0">setupPolygonizer</a>();
00705                         }
00706                         <span class="keywordflow">break</span>;
00707                 <span class="keywordflow">case</span> GLUT_KEY_LEFT:
00708                         {
00709                                 <a class="code" href="classdg_1_1Visualizer.html#n30">m_fOffsetX</a> += 0.1;
00710                                 <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a9">setOffset</a>( <a class="code" href="classdg_1_1Visualizer.html#n30">m_fOffsetX</a>, <a class="code" href="classdg_1_1Visualizer.html#n31">m_fOffsetY</a>, <a class="code" href="classdg_1_1Visualizer.html#n32">m_fOffsetZ</a> );
00711                                 <a class="code" href="classdg_1_1Visualizer.html#b0">setupPolygonizer</a>();
00712                         }
00713                         <span class="keywordflow">break</span>;
00714                 <span class="keywordflow">case</span> GLUT_KEY_RIGHT :
00715                         {
00716                                 <a class="code" href="classdg_1_1Visualizer.html#n30">m_fOffsetX</a> -= 0.1;
00717                                 <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a9">setOffset</a>( <a class="code" href="classdg_1_1Visualizer.html#n30">m_fOffsetX</a>, <a class="code" href="classdg_1_1Visualizer.html#n31">m_fOffsetY</a>, <a class="code" href="classdg_1_1Visualizer.html#n32">m_fOffsetZ</a> );
00718                                 <a class="code" href="classdg_1_1Visualizer.html#b0">setupPolygonizer</a>();
00719                         }
00720                         <span class="keywordflow">break</span>;
00721                 <span class="keywordflow">case</span> GLUT_KEY_UP :
00722                         {
00723                                 <a class="code" href="classdg_1_1Visualizer.html#n31">m_fOffsetY</a> -= 0.1;
00724                                 <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a9">setOffset</a>( <a class="code" href="classdg_1_1Visualizer.html#n30">m_fOffsetX</a>, <a class="code" href="classdg_1_1Visualizer.html#n31">m_fOffsetY</a>, <a class="code" href="classdg_1_1Visualizer.html#n32">m_fOffsetZ</a> );
00725                                 <a class="code" href="classdg_1_1Visualizer.html#b0">setupPolygonizer</a>();
00726                         }
00727                         <span class="keywordflow">break</span>;
00728                 <span class="keywordflow">case</span> GLUT_KEY_DOWN :
00729                         {
00730                                 <a class="code" href="classdg_1_1Visualizer.html#n31">m_fOffsetY</a> += 0.1;
00731                                 <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a9">setOffset</a>( <a class="code" href="classdg_1_1Visualizer.html#n30">m_fOffsetX</a>, <a class="code" href="classdg_1_1Visualizer.html#n31">m_fOffsetY</a>, <a class="code" href="classdg_1_1Visualizer.html#n32">m_fOffsetZ</a> );
00732                                 <a class="code" href="classdg_1_1Visualizer.html#b0">setupPolygonizer</a>();
00733                         }
00734                         <span class="keywordflow">break</span>;
00735 
00736         }
00737 }
00738 <span class="comment">//******************************************************************************</span>
<a name="l00739"></a><a class="code" href="classdg_1_1Visualizer.html#b0">00739</a> <span class="keywordtype">void</span> Visualizer::setupPolygonizer()
00740 {
00741         <a class="code" href="classdg_1_1Visualizer.html#n51">m_uiFuncIndex</a> = <a class="code" href="classdg_1_1Visualizer.html#n51">m_uiFuncIndex</a> % ImplicitFuncCount;
00742         <a class="code" href="classdg_1_1Visualizer.html#n52">m_aucFuncName</a> = ImplicitFunc[ <a class="code" href="classdg_1_1Visualizer.html#n51">m_uiFuncIndex</a> ].name;
00743         <a class="code" href="classdg_1_1Visualizer.html#n53">m_pvFunction</a> = ImplicitFunc[ <a class="code" href="classdg_1_1Visualizer.html#n51">m_uiFuncIndex</a> ].op;
00744 
00745         <span class="comment">// set the current options</span>
00746         <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a5">setCellCount</a>( <a class="code" href="classdg_1_1Visualizer.html#n23">m_iCellCount</a> );
00747         <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a11">setScale</a>( <a class="code" href="classdg_1_1Visualizer.html#n24">m_fScale</a> );
00748         <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a7">setIsoLevel</a>( <a class="code" href="classdg_1_1Visualizer.html#n25">m_fIsoLevel</a> );
00749         <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a9">setOffset</a>( <a class="code" href="classdg_1_1Visualizer.html#n30">m_fOffsetX</a>, <a class="code" href="classdg_1_1Visualizer.html#n31">m_fOffsetY</a>, <a class="code" href="classdg_1_1Visualizer.html#n32">m_fOffsetZ</a> );
00750         <a class="code" href="classdg_1_1Visualizer.html#n43">m_kPolygonizer</a>.<a class="code" href="classdg_1_1Polygonizer.html#a2">setFunction</a>( <a class="code" href="classdg_1_1Visualizer.html#n53">m_pvFunction</a> );
00751 
00752         <a class="code" href="classdg_1_1Visualizer.html#n16">m_bPolygonized</a> = <span class="keyword">false</span>;
00753         <a class="code" href="classdg_1_1Visualizer.html#n7">m_bUpdate</a> = <span class="keyword">true</span>;
00754         <a class="code" href="classdg_1_1Window.html#a8">postRedisplay</a>();
00755         <span class="keywordflow">return</span>;
00756 }
00757 <span class="comment">//******************************************************************************</span>
<a name="l00758"></a><a class="code" href="classdg_1_1Visualizer.html#b1">00758</a> <span class="keywordtype">void</span> Visualizer::setupRayTracer()
00759 {
00760         <a class="code" href="classdg_1_1Visualizer.html#n51">m_uiFuncIndex</a> = <a class="code" href="classdg_1_1Visualizer.html#n51">m_uiFuncIndex</a> % ImplicitFuncCount;
00761         <a class="code" href="classdg_1_1Visualizer.html#n52">m_aucFuncName</a> = ImplicitFunc[ <a class="code" href="classdg_1_1Visualizer.html#n51">m_uiFuncIndex</a> ].name;
00762         <a class="code" href="classdg_1_1Visualizer.html#n53">m_pvFunction</a> = ImplicitFunc[ <a class="code" href="classdg_1_1Visualizer.html#n51">m_uiFuncIndex</a> ].op;
00763 
00764         <span class="comment">// setup the camera</span>
00765         <a class="code" href="classdg_1_1Visualizer.html#b3">setupCamera</a>(<a class="code" href="classdg_1_1Visualizer.html#n46">m_kRayTracerCam</a>);
00766 
00767         <span class="comment">// setup the image</span>
00768         <a class="code" href="classdg_1_1Visualizer.html#n47">m_kRayTracerImage</a>.<a class="code" href="classdg_1_1Image.html#a21">setClearColor</a>( <a class="code" href="classdg_1_1Window.html#a29">bg</a>() );
00769         <a class="code" href="classdg_1_1Visualizer.html#n47">m_kRayTracerImage</a>.<a class="code" href="classdg_1_1Image.html#a22">resize</a>( <a class="code" href="classdg_1_1Window.html#a27">width</a>(), <a class="code" href="classdg_1_1Window.html#a28">height</a>(), 4 );
00770         <a class="code" href="classdg_1_1Visualizer.html#n46">m_kRayTracerCam</a>.<a class="code" href="classdg_1_1Camera.html#a27">setImage</a>( &amp;<a class="code" href="classdg_1_1Visualizer.html#n47">m_kRayTracerImage</a> );
00771 
00772         <span class="comment">// initialize raytracer</span>
00773         <a class="code" href="classdg_1_1Visualizer.html#n45">m_kRayTracer</a>.<a class="code" href="classdg_1_1RayTracer.html#a15">setSamples</a>((<a class="code" href="namespacedg.html#a15">UInt</a>)(<a class="code" href="classdg_1_1Visualizer.html#n23">m_iCellCount</a> * <a class="code" href="classdg_1_1Visualizer.html#q0">ms_fCellToRayScale</a>));
00774 
00775         <span class="comment">// set the light to the cameras direction</span>
00776         <a class="code" href="classdg_1_1Visualizer.html#n45">m_kRayTracer</a>.<a class="code" href="classdg_1_1RayTracer.html#a6">setLightDirection</a>( -<a class="code" href="classdg_1_1Visualizer.html#n46">m_kRayTracerCam</a>.<a class="code" href="classdg_1_1Camera.html#a5">getDirection</a>() );
00777 
00778         <span class="comment">// blur the resulting image to reduce aliasing</span>
00779         <a class="code" href="classdg_1_1Visualizer.html#n45">m_kRayTracer</a>.<a class="code" href="classdg_1_1RayTracer.html#a18">setBlur</a>(<span class="keyword">true</span>);
00780 
00781         <span class="comment">// set the current isolevel</span>
00782         <a class="code" href="classdg_1_1Visualizer.html#n45">m_kRayTracer</a>.<a class="code" href="classdg_1_1RayTracer.html#a13">setIsoLevel</a>(<a class="code" href="classdg_1_1Visualizer.html#n25">m_fIsoLevel</a>);
00783 
00784         <span class="comment">// set the background and material colors</span>
00785         <span class="comment">//m_kRayTracer.setBackground( bg() );</span>
00786         <a class="code" href="classdg_1_1Visualizer.html#n45">m_kRayTracer</a>.<a class="code" href="classdg_1_1RayTracer.html#a31">setBaseColor</a>( <a class="code" href="classdg_1_1Color.html">Color</a>(0.0, 0.10, 1.0) );
00787         <a class="code" href="classdg_1_1Visualizer.html#n45">m_kRayTracer</a>.<a class="code" href="classdg_1_1RayTracer.html#a4">setFunction</a>( <a class="code" href="classdg_1_1Visualizer.html#n53">m_pvFunction</a> );
00788 
00789         <span class="comment">// toggle update flags</span>
00790         <a class="code" href="classdg_1_1Visualizer.html#n14">m_bRayTraced</a> = <span class="keyword">false</span>;
00791         <a class="code" href="classdg_1_1Visualizer.html#n7">m_bUpdate</a> = <span class="keyword">true</span>;
00792 
00793         <span class="comment">// request refresh</span>
00794         <a class="code" href="classdg_1_1Window.html#a8">postRedisplay</a>();
00795         <span class="keywordflow">return</span>;
00796 }
00797 <span class="comment">//******************************************************************************</span>
<a name="l00798"></a><a class="code" href="classdg_1_1Visualizer.html#b2">00798</a> <span class="keywordtype">void</span> Visualizer::setupHypertexture()
00799 {
00800         <a class="code" href="classdg_1_1Visualizer.html#n51">m_uiFuncIndex</a> = <a class="code" href="classdg_1_1Visualizer.html#n51">m_uiFuncIndex</a> % DensityFuncCount;
00801         <a class="code" href="classdg_1_1Visualizer.html#n52">m_aucFuncName</a> = DensityFunc[ <a class="code" href="classdg_1_1Visualizer.html#n51">m_uiFuncIndex</a> ].name;
00802         <a class="code" href="classdg_1_1Visualizer.html#n53">m_pvFunction</a> = DensityFunc[ <a class="code" href="classdg_1_1Visualizer.html#n51">m_uiFuncIndex</a> ].op;
00803 
00804         <span class="comment">// setup the camera for current view</span>
00805         <a class="code" href="classdg_1_1Visualizer.html#b3">setupCamera</a>(<a class="code" href="classdg_1_1Visualizer.html#n49">m_kHyperCam</a>);
00806 
00807         <span class="comment">// setup the image</span>
00808         <span class="comment">//m_kHyperImage.setClearColor( bg() );</span>
00809         <a class="code" href="classdg_1_1Visualizer.html#n50">m_kHyperImage</a>.<a class="code" href="classdg_1_1Image.html#a22">resize</a>( <a class="code" href="classdg_1_1Window.html#a27">width</a>(), <a class="code" href="classdg_1_1Window.html#a28">height</a>(), 4 );
00810         <a class="code" href="classdg_1_1Visualizer.html#n49">m_kHyperCam</a>.<a class="code" href="classdg_1_1Camera.html#a27">setImage</a>( &amp;<a class="code" href="classdg_1_1Visualizer.html#n50">m_kHyperImage</a> );
00811 
00812         <span class="comment">// set the light to the cameras direction</span>
00813         <span class="comment">//m_kHyper.setLightDirection( -m_kHyperCam.getDirection() );</span>
00814         <a class="code" href="classdg_1_1Visualizer.html#n48">m_kHyper</a>.<a class="code" href="classdg_1_1Hypertexture.html#a38">setStepSize</a>( <a class="code" href="classdg_1_1Visualizer.html#q1">ms_fCellToHyperStepScale</a> / <a class="code" href="classdg_1_1Visualizer.html#n23">m_iCellCount</a>);
00815 
00816         <span class="comment">// set the background and material colors</span>
00817         <span class="comment">//m_kHyper.setBackground( bg() );</span>
00818 
00819         <a class="code" href="classdg_1_1Visualizer.html#n48">m_kHyper</a>.<a class="code" href="classdg_1_1Hypertexture.html#a2">setDensityFunction</a>( <a class="code" href="classdg_1_1Visualizer.html#n53">m_pvFunction</a> );
00820         <a class="code" href="classdg_1_1Visualizer.html#n48">m_kHyper</a>.<a class="code" href="classdg_1_1Hypertexture.html#a6">setFilteredColorFunction</a>( <a class="code" href="namespacedg.html#a189">FilteredClownColorVolume</a> );
00821         <a class="code" href="classdg_1_1Visualizer.html#n48">m_kHyper</a>.<a class="code" href="classdg_1_1Hypertexture.html#a45">setKeepInView</a>( <a class="code" href="classdg_1_1Visualizer.html#n17">m_bKeepInView</a> );
00822         <a class="code" href="classdg_1_1Visualizer.html#n48">m_kHyper</a>.<a class="code" href="classdg_1_1Hypertexture.html#a47">setFadeOut</a>( <a class="code" href="classdg_1_1Visualizer.html#n18">m_bFadeOut</a> );
00823         <a class="code" href="classdg_1_1Visualizer.html#n48">m_kHyper</a>.<a class="code" href="classdg_1_1Hypertexture.html#a13">setScale</a>( 1.0f/<a class="code" href="classdg_1_1Visualizer.html#n24">m_fScale</a> );
00824 
00825         <span class="comment">//m_kHyper.setShadingFunction( Phong );</span>
00826 
00827         <span class="comment">// toggle update flags</span>
00828         <a class="code" href="classdg_1_1Visualizer.html#n15">m_bHyperTraced</a> = <span class="keyword">false</span>;
00829         <a class="code" href="classdg_1_1Visualizer.html#n7">m_bUpdate</a> = <span class="keyword">true</span>;
00830 
00831         <span class="comment">// request refresh</span>
00832         <a class="code" href="classdg_1_1Window.html#a8">postRedisplay</a>();
00833         <span class="keywordflow">return</span>;
00834 }
00835 <span class="comment">//******************************************************************************</span>
<a name="l00836"></a><a class="code" href="classdg_1_1Visualizer.html#b5">00836</a> <span class="keywordtype">void</span> Visualizer::setBackground()
00837 {
00838         <a class="code" href="namespacedg.html#a28">Real</a> afBackgroundColor[] = {0.10, 0.10, 0.10, 1.00 };
00839 
00840         glClearColor( afBackgroundColor[0],
00841                                   afBackgroundColor[1],
00842                                   afBackgroundColor[2],
00843                                   afBackgroundColor[3] );
00844 
00845         glClearDepth( 1.0 );
00846 
00847         glClear( GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT );
00848 
00849 }
00850 <span class="comment">//******************************************************************************</span>
<a name="l00851"></a><a class="code" href="classdg_1_1Visualizer.html#b6">00851</a> <span class="keywordtype">void</span> Visualizer::setLights()
00852 {
00853         <a class="code" href="namespacedg.html#a28">Real</a> afLightAmbient [] = {0.50, 0.50, 0.50, 1.00 };
00854         <a class="code" href="namespacedg.html#a28">Real</a> afLightDiffuse [] = {0.75, 0.75, 0.75, 1.00 };
00855         <a class="code" href="namespacedg.html#a28">Real</a> afLightSpecular[] = {1.00, 1.00, 1.00, 1.00 };
00856 
00857         glEnable(GL_DEPTH_TEST);
00858         glEnable(GL_LIGHTING);
00859         glPolygonMode(GL_FRONT_AND_BACK, <a class="code" href="classdg_1_1Visualizer.html#n42">m_ePolyMode</a>);
00860 
00861         glLightfv( GL_LIGHT0, GL_AMBIENT, afLightAmbient);
00862         glLightfv( GL_LIGHT0, GL_DIFFUSE, afLightDiffuse);
00863         glLightfv( GL_LIGHT0, GL_SPECULAR, afLightSpecular);
00864         glLightModelf(GL_LIGHT_MODEL_TWO_SIDE, 1.0);
00865 
00866         glEnable( GL_LIGHT0 );
00867 }
00868 <span class="comment">//******************************************************************************</span>
<a name="l00869"></a><a class="code" href="classdg_1_1Visualizer.html#b7">00869</a> <span class="keywordtype">void</span> Visualizer::setMaterials()
00870 {
00871         <a class="code" href="namespacedg.html#a28">Real</a> fAlpha = 1.0 - <a class="code" href="classdg_1_1Visualizer.html#n29">m_fTransparency</a>;
00872         <a class="code" href="namespacedg.html#a28">Real</a> fShininess = 0.20;
00873 
00874         <a class="code" href="namespacedg.html#a28">Real</a> afAmbientRed [] =   { 0.25, 0.10, 0.00, fAlpha };
00875         <a class="code" href="namespacedg.html#a28">Real</a> afAmbientBlue [] =  { 0.00, 0.00, 0.25, fAlpha };
00876 
00877         <a class="code" href="namespacedg.html#a28">Real</a> afDiffuseRed [] =   { 1.00, 0.80, 0.00, fAlpha };
00878         <a class="code" href="namespacedg.html#a28">Real</a> afDiffuseBlue [] =  { 0.00, 0.00, 0.75, fAlpha };
00879 
00880         <a class="code" href="namespacedg.html#a28">Real</a> afSpecularWhite[] = { 0.50, 0.50, 0.50, fAlpha*0.5 };
00881 
00882         glMaterialfv(GL_BACK, GL_AMBIENT, afAmbientBlue);
00883         glMaterialfv(GL_BACK, GL_DIFFUSE, afDiffuseBlue);
00884         glMaterialfv(GL_FRONT, GL_AMBIENT, afAmbientRed);
00885         glMaterialfv(GL_FRONT, GL_DIFFUSE, afDiffuseRed);
00886         glMaterialfv(GL_FRONT, GL_SPECULAR, afSpecularWhite);
00887         glMaterialf( GL_FRONT, GL_SHININESS, fShininess);
00888 
00889         glEnable( GL_BLEND );
00890 <span class="comment">//      glBlendFunc();</span>
00891 
00892 }
00893 <span class="comment">//******************************************************************************</span>
<a name="l00894"></a><a class="code" href="classdg_1_1Visualizer.html#b3">00894</a> <span class="keywordtype">void</span> Visualizer::setupCamera(<a class="code" href="classdg_1_1Camera.html">Camera</a>&amp; rkCamera)
00895 {
00896 
00897         <span class="comment">// translate the camera due to function scale (not needed for polygonizer)</span>
00898         <a class="code" href="classdg_1_1Vector.html">Vector</a> kTranslate;
00899         <a class="code" href="classdg_1_1Vector.html">Vector</a> kCameraPos( <a class="code" href="classdg_1_1Visualizer.html#n33">m_fCameraX</a>, <a class="code" href="classdg_1_1Visualizer.html#n34">m_fCameraY</a>, <a class="code" href="classdg_1_1Visualizer.html#n35">m_fCameraZ</a> );
00900         <span class="keywordflow">if</span>(&amp;rkCamera != &amp;<a class="code" href="classdg_1_1Visualizer.html#n44">m_kPolyCam</a>)
00901         {
00902                 <a class="code" href="classdg_1_1Visualizer.html#b4">setupFrustum</a>( <a class="code" href="classdg_1_1Window.html#a27">width</a>(), <a class="code" href="classdg_1_1Window.html#a28">height</a>(), <span class="keyword">false</span> );
00903                 kTranslate = <a class="code" href="classdg_1_1Vector.html">Vector</a>(-<a class="code" href="classdg_1_1Visualizer.html#n30">m_fOffsetX</a>, -<a class="code" href="classdg_1_1Visualizer.html#n31">m_fOffsetY</a>, -<a class="code" href="classdg_1_1Visualizer.html#n24">m_fScale</a>-<a class="code" href="classdg_1_1Visualizer.html#n32">m_fOffsetZ</a>);
00904 
00905                 <span class="comment">// intialize view frustum</span>
00906                 rkCamera.<a class="code" href="classdg_1_1Camera.html#a11">setNear</a>( <a class="code" href="classdg_1_1Visualizer.html#n40">m_fFrustumNear</a> + <a class="code" href="classdg_1_1Visualizer.html#n24">m_fScale</a>);
00907                 rkCamera.<a class="code" href="classdg_1_1Camera.html#a13">setFar</a>( <a class="code" href="classdg_1_1Visualizer.html#n41">m_fFrustumFar</a> );
00908         }
00909         <span class="keywordflow">else</span>
00910         {
00911                 <a class="code" href="classdg_1_1Visualizer.html#b4">setupFrustum</a>( <a class="code" href="classdg_1_1Window.html#a27">width</a>(), <a class="code" href="classdg_1_1Window.html#a28">height</a>(), <a class="code" href="classdg_1_1Visualizer.html#n5">m_bUsePerspective</a> );
00912                 <span class="keywordflow">if</span>(!<a class="code" href="classdg_1_1Visualizer.html#n5">m_bUsePerspective</a>)
00913                         kTranslate = <a class="code" href="classdg_1_1Vector.html">Vector</a>(-<a class="code" href="classdg_1_1Visualizer.html#n30">m_fOffsetX</a>, -<a class="code" href="classdg_1_1Visualizer.html#n31">m_fOffsetY</a>, -<a class="code" href="classdg_1_1Visualizer.html#n32">m_fOffsetZ</a>);
00914                 <span class="keywordflow">else</span>
00915                         kTranslate = <a class="code" href="classdg_1_1Vector.html">Vector</a>(-0.5, -0.5, -0.5);
00916 
00917                 <span class="comment">// intialize view frustum</span>
00918                 rkCamera.<a class="code" href="classdg_1_1Camera.html#a11">setNear</a>( <a class="code" href="classdg_1_1Visualizer.html#n40">m_fFrustumNear</a> );
00919                 rkCamera.<a class="code" href="classdg_1_1Camera.html#a13">setFar</a>( <a class="code" href="classdg_1_1Visualizer.html#n41">m_fFrustumFar</a> );
00920         }
00921 
00922         <span class="comment">// intialize camera frame</span>
00923         rkCamera.<a class="code" href="classdg_1_1Camera.html#a4">setPosition</a>( kCameraPos - kTranslate );
00924 
00925         <span class="comment">//rkCamera.setPosition( kTranslate );</span>
00926         rkCamera.<a class="code" href="classdg_1_1Camera.html#a6">setDirection</a>( <a class="code" href="classdg_1_1Vector.html">Vector</a>(0.0f,0.0f,-1.0f) );
00927         rkCamera.<a class="code" href="classdg_1_1Camera.html#a8">setUp</a>( <a class="code" href="classdg_1_1Vector.html">Vector</a>(0.0f,1.0f,0.0f) );
00928         rkCamera.<a class="code" href="classdg_1_1Camera.html#a10">setRight</a>( <a class="code" href="classdg_1_1Vector.html">Vector</a>(-1.0f,0.0f,0.0f) );
00929 
00930         <span class="comment">// set the fov to 90 degrees</span>
00931         <span class="keywordflow">if</span>( <a class="code" href="classdg_1_1Visualizer.html#n37">m_fFrustumRight</a> &gt; <a class="code" href="classdg_1_1Visualizer.html#n36">m_fFrustumLeft</a> )
00932                 rkCamera.<a class="code" href="classdg_1_1Camera.html#a15">setHalfWidth</a>( <a class="code" href="classdg_1_1Visualizer.html#n37">m_fFrustumRight</a> - <a class="code" href="classdg_1_1Visualizer.html#n36">m_fFrustumLeft</a> );
00933         <span class="keywordflow">else</span>
00934                 rkCamera.<a class="code" href="classdg_1_1Camera.html#a15">setHalfWidth</a>( <a class="code" href="classdg_1_1Visualizer.html#n36">m_fFrustumLeft</a> - <a class="code" href="classdg_1_1Visualizer.html#n37">m_fFrustumRight</a> );
00935 
00936         <span class="keywordflow">if</span>( <a class="code" href="classdg_1_1Visualizer.html#n39">m_fFrustumTop</a> &gt; <a class="code" href="classdg_1_1Visualizer.html#n38">m_fFrustumBottom</a> )
00937                 rkCamera.<a class="code" href="classdg_1_1Camera.html#a19">setHalfHeight</a>( <a class="code" href="classdg_1_1Visualizer.html#n39">m_fFrustumTop</a> - <a class="code" href="classdg_1_1Visualizer.html#n38">m_fFrustumBottom</a> );
00938         <span class="keywordflow">else</span>
00939                 rkCamera.<a class="code" href="classdg_1_1Camera.html#a19">setHalfHeight</a>( <a class="code" href="classdg_1_1Visualizer.html#n38">m_fFrustumBottom</a> - <a class="code" href="classdg_1_1Visualizer.html#n39">m_fFrustumTop</a> );
00940 
00941         <span class="comment">// rotate to current view</span>
00942         <a class="code" href="classdg_1_1Matrix.html">Matrix</a> kMR;
00943         <a class="code" href="namespacedg.html#a28">Real</a> fLength = rkCamera.<a class="code" href="classdg_1_1Camera.html#a3">getPosition</a>().<a class="code" href="classdg_1_1Vector.html#a32">length</a>();
00944 
00945         <span class="comment">// first rotate about x axis</span>
00946         kMR = Matrix::buildRotation( <a class="code" href="classdg_1_1Vector.html">Vector</a>(<a class="code" href="classdg_1_1Visualizer.html#n19">m_iSpinX</a>/2.0f, 0, 0));
00947         rkCamera.<a class="code" href="classdg_1_1Camera.html#a6">setDirection</a>( kMR*rkCamera.<a class="code" href="classdg_1_1Camera.html#a5">getDirection</a>() );
00948         rkCamera.<a class="code" href="classdg_1_1Camera.html#a8">setUp</a>( kMR*rkCamera.<a class="code" href="classdg_1_1Camera.html#a7">getUp</a>() );
00949         rkCamera.<a class="code" href="classdg_1_1Camera.html#a4">setPosition</a>(-fLength*rkCamera.<a class="code" href="classdg_1_1Camera.html#a5">getDirection</a>());
00950 
00951         <span class="comment">// then rotate about y axis</span>
00952         kMR = Matrix::buildRotation( <a class="code" href="classdg_1_1Vector.html">Vector</a>(0, <a class="code" href="classdg_1_1Visualizer.html#n20">m_iSpinY</a>/2.0f, 0));
00953         rkCamera.<a class="code" href="classdg_1_1Camera.html#a6">setDirection</a>( kMR*rkCamera.<a class="code" href="classdg_1_1Camera.html#a5">getDirection</a>() );
00954         rkCamera.<a class="code" href="classdg_1_1Camera.html#a8">setUp</a>( kMR*rkCamera.<a class="code" href="classdg_1_1Camera.html#a7">getUp</a>() );
00955         rkCamera.<a class="code" href="classdg_1_1Camera.html#a4">setPosition</a>(-fLength*rkCamera.<a class="code" href="classdg_1_1Camera.html#a5">getDirection</a>());
00956 }
00957 <span class="comment">//******************************************************************************</span>
<a name="l00958"></a><a class="code" href="classdg_1_1Visualizer.html#b4">00958</a> <span class="keywordtype">void</span> Visualizer::setupFrustum( <a class="code" href="namespacedg.html#a14">Int</a> iWidth, <a class="code" href="namespacedg.html#a14">Int</a> iHeight, <span class="keywordtype">bool</span> bPerspective )
00959 {
00960         <a class="code" href="namespacedg.html#a28">Real</a> fAspect = 0;
00961         <a class="code" href="namespacedg.html#a28">Real</a> fVolume = 0;
00962 
00963         <span class="keywordflow">if</span> (iWidth &lt;= iHeight)
00964                 fAspect = (Real)iHeight / (Real)iWidth;
00965         <span class="keywordflow">else</span>
00966                 fAspect = (Real)iWidth / (Real)iHeight;
00967 
00968         <span class="keywordflow">if</span>(!bPerspective)
00969         {
00970                 fVolume = sqrt(2) / 2.0;
00971                 <a class="code" href="classdg_1_1Visualizer.html#n40">m_fFrustumNear</a> = -10 * fVolume;
00972                 <a class="code" href="classdg_1_1Visualizer.html#n41">m_fFrustumFar</a> = 10 * fVolume;
00973         }
00974         <span class="keywordflow">else</span>
00975         {
00976                 <a class="code" href="classdg_1_1Visualizer.html#n40">m_fFrustumNear</a> = 0.1;
00977                 <a class="code" href="classdg_1_1Visualizer.html#n41">m_fFrustumFar</a> = 10;
00978                 fVolume = <a class="code" href="classdg_1_1Visualizer.html#n40">m_fFrustumNear</a>;       <span class="comment">// 45 degrees</span>
00979         }
00980 
00981         <span class="keywordflow">if</span> (iWidth &lt;= iHeight)
00982         {
00983                 <a class="code" href="classdg_1_1Visualizer.html#n36">m_fFrustumLeft</a> = -fVolume;
00984                 <a class="code" href="classdg_1_1Visualizer.html#n37">m_fFrustumRight</a> = fVolume;
00985                 <a class="code" href="classdg_1_1Visualizer.html#n38">m_fFrustumBottom</a> = -fVolume * fAspect;
00986                 <a class="code" href="classdg_1_1Visualizer.html#n39">m_fFrustumTop</a> = fVolume * fAspect;
00987         }
00988         <span class="keywordflow">else</span>
00989         {
00990                 <a class="code" href="classdg_1_1Visualizer.html#n36">m_fFrustumLeft</a> = -fVolume * fAspect;
00991                 <a class="code" href="classdg_1_1Visualizer.html#n37">m_fFrustumRight</a> = fVolume * fAspect;
00992                 <a class="code" href="classdg_1_1Visualizer.html#n38">m_fFrustumBottom</a> = -fVolume;
00993                 <a class="code" href="classdg_1_1Visualizer.html#n39">m_fFrustumTop</a> = fVolume;
00994         }
00995 }
00996 <span class="comment">//******************************************************************************</span>
<a name="l00997"></a><a class="code" href="classdg_1_1Visualizer.html#b8">00997</a> <span class="keywordtype">void</span> Visualizer::startCalcTimer()
00998 {
00999         <a class="code" href="classdg_1_1Window.html#n17">m_kTimer</a>.<a class="code" href="classdg_1_1Timer.html#a6">reset</a>();
01000         <a class="code" href="classdg_1_1Window.html#n17">m_kTimer</a>.<a class="code" href="classdg_1_1Timer.html#a2">start</a>();
01001 
01002         <a class="code" href="classdg_1_1Visualizer.html#n1">m_uiHours</a> = 0;
01003         <a class="code" href="classdg_1_1Visualizer.html#n2">m_uiMinutes</a> = 0;
01004         <a class="code" href="classdg_1_1Visualizer.html#n3">m_uiSeconds</a> = 0;
01005         <a class="code" href="classdg_1_1Visualizer.html#n4">m_uiMilliSecs</a> = 0;
01006 }
01007 <span class="comment">//******************************************************************************</span>
<a name="l01008"></a><a class="code" href="classdg_1_1Visualizer.html#b10">01008</a> <span class="keywordtype">void</span> Visualizer::stopCalcTimer()
01009 {
01010         <span class="comment">// dont stop the timer, just grab the current time values</span>
01011         <a class="code" href="classdg_1_1Visualizer.html#b9">updateCalcTimer</a>();
01012 }
01013 <span class="comment">//******************************************************************************</span>
<a name="l01014"></a><a class="code" href="classdg_1_1Visualizer.html#b9">01014</a> <span class="keywordtype">void</span> Visualizer::updateCalcTimer()
01015 {
01016         <a class="code" href="classdg_1_1Visualizer.html#n1">m_uiHours</a> = <a class="code" href="classdg_1_1Window.html#n17">m_kTimer</a>.<a class="code" href="classdg_1_1Timer.html#a10">elapsedHours</a>();
01017         <a class="code" href="classdg_1_1Visualizer.html#n2">m_uiMinutes</a> = <a class="code" href="classdg_1_1Window.html#n17">m_kTimer</a>.<a class="code" href="classdg_1_1Timer.html#a11">elapsedMinutes</a>() % 60;
01018         <a class="code" href="classdg_1_1Visualizer.html#n3">m_uiSeconds</a> = <a class="code" href="classdg_1_1Window.html#n17">m_kTimer</a>.<a class="code" href="classdg_1_1Timer.html#a12">elapsedSeconds</a>() % 60;
01019         <a class="code" href="classdg_1_1Visualizer.html#n4">m_uiMilliSecs</a> = <a class="code" href="classdg_1_1Window.html#n17">m_kTimer</a>.<a class="code" href="classdg_1_1Timer.html#a13">elapsedMilliseconds</a>() % 1000;
01020 }
01021 <span class="comment">//******************************************************************************</span>
<a name="l01022"></a><a class="code" href="classdg_1_1Visualizer.html#b11">01022</a> <span class="keywordtype">void</span> Visualizer::update(<a class="code" href="namespacedg.html#a28">Real</a> fDT)
01023 {
01024         <a class="code" href="classdg_1_1Visualizer.html#n26">m_fUpdateOffset</a> = 0.8 + <a class="code" href="namespacedg.html#a116">Sine</a>(fDT);
01025 
01026         <a class="code" href="classdg_1_1Visualizer.html#n30">m_fOffsetX</a> = -0.5f * <a class="code" href="classdg_1_1Visualizer.html#n26">m_fUpdateOffset</a>;
01027         <a class="code" href="classdg_1_1Visualizer.html#n31">m_fOffsetY</a> = -0.5f * <a class="code" href="classdg_1_1Visualizer.html#n26">m_fUpdateOffset</a>;
01028         <a class="code" href="classdg_1_1Visualizer.html#n32">m_fOffsetZ</a> = -0.5f * <a class="code" href="classdg_1_1Visualizer.html#n26">m_fUpdateOffset</a>;
01029 
01030         <span class="keywordflow">if</span>(<a class="code" href="classdg_1_1Visualizer.html#n54">m_eVisMode</a> == <a class="code" href="classdg_1_1Visualizer.html#s5s0">VM_MARCHING_CUBES</a> || <a class="code" href="classdg_1_1Visualizer.html#n54">m_eVisMode</a> == <a class="code" href="classdg_1_1Visualizer.html#s5s1">VM_MARCHING_TETRA</a>)
01031                 <a class="code" href="classdg_1_1Visualizer.html#b0">setupPolygonizer</a>();
01032         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classdg_1_1Visualizer.html#n54">m_eVisMode</a> == <a class="code" href="classdg_1_1Visualizer.html#s5s2">VM_RAYTRACE</a>)
01033                 <a class="code" href="classdg_1_1Visualizer.html#b1">setupRayTracer</a>();
01034         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classdg_1_1Visualizer.html#n54">m_eVisMode</a> == <a class="code" href="classdg_1_1Visualizer.html#s5s3">VM_HYPERTEXTURE</a>)
01035                 <a class="code" href="classdg_1_1Visualizer.html#b2">setupHypertexture</a>();
01036 
01037         <a class="code" href="classdg_1_1Visualizer.html#n27">m_fTime</a> = fDT;
01038 }
01039 <span class="comment">//******************************************************************************</span>
01040 
</pre></div>		<div class="footer" width="100%">
		<hr>
			<a href="http://lyon-smith.org/">&copy; Derek Gerstmann - NCCA - Bournemouth University - 2004</a>
		</div>
		<br>
	</body>
</html>
