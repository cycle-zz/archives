<html>
	<head>
		<title>Branch - API Documentation</title>
		<link HREF="style.css" REL="stylesheet" TYPE="text/css">
	</head>
	<body>
		<div width="100%" height="40px" class="banner">
			Visualizer - API Documentation
		</div>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Timer.cpp</h1><a href="Timer_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">// #############################################################################</span>
00002 <span class="comment">// # Timer.cpp  -  Basic Timer for profiling and gathering time info</span>
00003 <span class="comment">// #</span>
00004 <span class="comment">// # Created    : Sat Jan 10 2004</span>
00005 <span class="comment">// # Copyright  : (C) 2004 by Derek Gerstmann</span>
00006 <span class="comment">// # Email      : dgerstma@acm.org</span>
00007 <span class="comment">// #</span>
00008 <span class="comment">// #############################################################################</span>
00009 
00010 <span class="comment">// ===================================================================</span>
00011 <span class="comment">//</span>
00012 <span class="comment">//  This program is free software; you can redistribute it and/or modify</span>
00013 <span class="comment">//  it under the terms of the GNU General Public License as published by</span>
00014 <span class="comment">//  the Free Software Foundation; either version 2 of the License, or</span>
00015 <span class="comment">//  (at your option) any later version.</span>
00016 <span class="comment">//</span>
00017 <span class="comment">// ===================================================================</span>
00018 
00019 
00020 <span class="preprocessor">#include "<a class="code" href="Timer_8h.html">Timer.h</a>"</span>
00021 
00022 <span class="preprocessor">#ifdef __APPLE__</span>
00023 <span class="preprocessor"></span><span class="preprocessor">#include &lt;ctime&gt;</span>
00024 <span class="preprocessor">#else</span>
00025 <span class="preprocessor"></span><span class="preprocessor">#include &lt;sys/time.h&gt;</span>
00026 <span class="preprocessor">#endif</span>
00027 <span class="preprocessor"></span>
00028 
00029 <span class="keyword">using</span> <span class="keyword">namespace </span>dg;
00030 
00031 <span class="comment">//******************************************************************************</span>
00032 <a class="code" href="namespacedg.html#a15">UInt</a> Timer::s_uiSecondsFrequency = 0;
00033 <a class="code" href="namespacedg.html#a15">UInt</a> Timer::s_uiMillisecondsFrequency = 0;
00034 <a class="code" href="namespacedg.html#a28">Real</a> Timer::s_fInvSecFrequency = 0.0f;
00035 <span class="comment">//******************************************************************************</span>
<a name="l00036"></a><a class="code" href="classdg_1_1Timer.html#a0">00036</a> Timer::Timer():
00037         m_uiElapsedCount(0),
00038         m_eState(TS_OFF)
00039 {
00040         setupTimerFrequency();
00041         <a class="code" href="classdg_1_1Timer.html#a6">reset</a>();
00042 }
00043 <span class="comment">//******************************************************************************</span>
00044 <span class="keywordtype">void</span> Timer::setupTimerFrequency()
00045 {
00046         <span class="keywordflow">if</span> (!s_uiSecondsFrequency)
00047         {
00048 
00049 <span class="preprocessor">#ifdef WIN32</span>
00050 <span class="preprocessor"></span>                LARGE_INTEGER iFrequency;
00051                 QueryPerformanceFrequency(&amp;iFrequency);
00052 
00053                 s_uiSecondsFrequency = iFrequency.LowPart;
00054                 s_uiMillisecondsFrequency = iFrequency.LowPart/1000;
00055 <span class="preprocessor">#else</span>
00056 <span class="preprocessor"></span>                <span class="keyword">struct </span>timeval kFrequency;
00057                 <span class="keyword">struct </span>timezone kTZ;
00058 
00059         gettimeofday(&amp;kFrequency, &amp;kTZ);
00060         s_uiSecondsFrequency = 1000000;
00061         s_uiMillisecondsFrequency = 1000;
00062 <span class="preprocessor">#endif</span>
00063 <span class="preprocessor"></span>
00064                 s_fInvSecFrequency = 1.0f/(Real)s_uiSecondsFrequency;
00065         }
00066 }
00067 <span class="comment">//******************************************************************************</span>
00068 <a class="code" href="namespacedg.html#a15">UInt</a> Timer::samplePerformanceCounter()
00069 {
00070 
00071 <span class="preprocessor">#ifdef WIN32</span>
00072 <span class="preprocessor"></span>                LARGE_INTEGER iSample;
00073                 QueryPerformanceCounter(&amp;iSample);
00074                 <span class="keywordflow">return</span> iSample.LowPart;
00075 <span class="preprocessor">#else</span>
00076 <span class="preprocessor"></span>                <span class="keyword">struct </span>timeval kSample;
00077                 <span class="keyword">struct </span>timezone kTZ;
00078 
00079         gettimeofday(&amp;kSample, &amp;kTZ);
00080                 <span class="keywordflow">return</span> kSample.tv_sec * 1000000 + kSample.tv_usec;
00081 <span class="preprocessor">#endif</span>
00082 <span class="preprocessor"></span>}
00083 <span class="comment">//******************************************************************************</span>
00084 <span class="comment">// end file: Timer.cpp</span>
</pre></div>		<div class="footer" width="100%">
		<hr>
			<a href="http://lyon-smith.org/">&copy; Derek Gerstmann - NCCA - Bournemouth University - 2004</a>
		</div>
		<br>
	</body>
</html>
