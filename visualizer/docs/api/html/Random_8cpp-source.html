<html>
	<head>
		<title>Branch - API Documentation</title>
		<link HREF="style.css" REL="stylesheet" TYPE="text/css">
	</head>
	<body>
		<div width="100%" height="40px" class="banner">
			Visualizer - API Documentation
		</div>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Random.cpp</h1><a href="Random_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="preprocessor">#include "<a class="code" href="Random_8h.html">Random.h</a>"</span>
00002 
00003 <span class="keyword">using</span> <span class="keyword">namespace </span>dg;
00004 
00005 <span class="comment">/*</span>
00006 <span class="comment">   Copyright (C) 1997 - 2002, Makoto Matsumoto and Takuji Nishimura,</span>
00007 <span class="comment">   All rights reserved.</span>
00008 <span class="comment"> </span>
00009 <span class="comment">   Redistribution and use in source and binary forms, with or without</span>
00010 <span class="comment">   modification, are permitted provided that the following conditions</span>
00011 <span class="comment">   are met:</span>
00012 <span class="comment"> </span>
00013 <span class="comment">     1. Redistributions of source code must retain the above copyright</span>
00014 <span class="comment">        notice, this list of conditions and the following disclaimer.</span>
00015 <span class="comment"> </span>
00016 <span class="comment">     2. Redistributions in binary form must reproduce the above copyright</span>
00017 <span class="comment">        notice, this list of conditions and the following disclaimer in the</span>
00018 <span class="comment">        documentation and/or other materials provided with the distribution.</span>
00019 <span class="comment"> </span>
00020 <span class="comment">     3. The names of its contributors may not be used to endorse or promote</span>
00021 <span class="comment">        products derived from this software without specific prior written</span>
00022 <span class="comment">        permission.</span>
00023 <span class="comment"> </span>
00024 <span class="comment">   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
00025 <span class="comment">   "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
00026 <span class="comment">   LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
00027 <span class="comment">   A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR</span>
00028 <span class="comment">   CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,</span>
00029 <span class="comment">   EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,</span>
00030 <span class="comment">   PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR</span>
00031 <span class="comment">   PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF</span>
00032 <span class="comment">   LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING</span>
00033 <span class="comment">   NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS</span>
00034 <span class="comment">   SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
00035 <span class="comment">*/</span>
00036 
<a name="l00037"></a><a class="code" href="Random_8cpp.html#a0">00037</a> <span class="preprocessor">#define N 624</span>
<a name="l00038"></a><a class="code" href="Random_8cpp.html#a1">00038</a> <span class="preprocessor"></span><span class="preprocessor">#define M 397</span>
<a name="l00039"></a><a class="code" href="Random_8cpp.html#a2">00039</a> <span class="preprocessor"></span><span class="preprocessor">#define MATRIX_A 0x9908b0dfUL   </span><span class="comment">/* constant vector a */</span>
<a name="l00040"></a><a class="code" href="Random_8cpp.html#a3">00040</a> <span class="preprocessor">#define UPPER_MASK 0x80000000UL </span><span class="comment">/* most significant w-r bits */</span>
<a name="l00041"></a><a class="code" href="Random_8cpp.html#a4">00041</a> <span class="preprocessor">#define LOWER_MASK 0x7fffffffUL </span><span class="comment">/* least significant r bits */</span>
00042 
00043 <span class="keyword">static</span> <a class="code" href="namespacedg.html#a15">UInt</a> mt[<a class="code" href="Random_8cpp.html#a0">N</a>]; <span class="comment">/* the array for the state vector  */</span>
00044 <span class="keyword">static</span> <span class="keywordtype">int</span> mti = <a class="code" href="Random_8cpp.html#a0">N</a> + 1; <span class="comment">/* mti==N+1 means mt[N] is not initialized */</span>
00045 
<a name="l00046"></a><a class="code" href="namespacedg.html#a166">00046</a> <span class="keywordtype">void</span> <a class="code" href="namespacedg.html#a166">dg::SeedRandom</a>(<a class="code" href="namespacedg.html#a17">ULong</a> seed)
00047 {
00048         mt[0] = seed &amp; 0xffffffffUL;
00049         <span class="keywordflow">for</span> (mti = 1; mti &lt; <a class="code" href="Random_8cpp.html#a0">N</a>; mti++)
00050         {
00051                 mt[mti] =
00052                     (1812433253UL * (mt[mti - 1] ^ (mt[mti - 1] &gt;&gt; 30)) + mti);
00053                 
00054                 <span class="comment">/* See Knuth TAOCP Vol2. 3rd Ed. P.106 for multiplier. */</span>
00055                 <span class="comment">/* In the previous versions, MSBs of the seed affect   */</span>
00056                 <span class="comment">/* only MSBs of the array mt[].                        */</span>
00057                 <span class="comment">/* 2002/01/09 modified by Makoto Matsumoto             */</span>
00058                 mt[mti] &amp;= 0xffffffffUL;
00059                 <span class="comment">/* for &gt;32 bit machines */</span>
00060         }
00061 }
00062 
00063 <span class="comment">/* generate a random 32bit unsigned int */</span> 
<a name="l00064"></a><a class="code" href="namespacedg.html#a167">00064</a> <a class="code" href="namespacedg.html#a15">UInt</a> <a class="code" href="namespacedg.html#a167">dg::RandomInt</a>(<span class="keywordtype">void</span>)
00065 {
00066         <a class="code" href="namespacedg.html#a15">UInt</a> y;
00067         <span class="keyword">static</span> <a class="code" href="namespacedg.html#a15">UInt</a> mag01[2] = {0x0UL, <a class="code" href="Random_8cpp.html#a2">MATRIX_A</a>};
00068         <span class="comment">/* mag01[x] = x * MATRIX_A  for x=0,1 */</span>
00069 
00070         <span class="keywordflow">if</span> (mti &gt;= <a class="code" href="Random_8cpp.html#a0">N</a>)
00071         { 
00072                 <span class="comment">/* generate N words at one time */</span>
00073                 <span class="keywordtype">int</span> kk;
00074 
00075                 <span class="keywordflow">if</span> (mti == <a class="code" href="Random_8cpp.html#a0">N</a> + 1)   <span class="comment">/* if init_genrand() has not been called, */</span>
00076                         <a class="code" href="namespacedg.html#a166">SeedRandom</a>(5489UL); <span class="comment">/* default initial seed */</span>
00077 
00078                 <span class="keywordflow">for</span> (kk = 0;kk &lt; <a class="code" href="Random_8cpp.html#a0">N</a> - <a class="code" href="Random_8cpp.html#a1">M</a>;kk++)
00079                 {
00080                         y = (mt[kk] &amp; <a class="code" href="Random_8cpp.html#a3">UPPER_MASK</a>) | (mt[kk + 1] &amp; <a class="code" href="Random_8cpp.html#a4">LOWER_MASK</a>);
00081                         mt[kk] = mt[kk + <a class="code" href="Random_8cpp.html#a1">M</a>] ^ (y &gt;&gt; 1) ^ mag01[y &amp; 0x1UL];
00082                 }
00083                 <span class="keywordflow">for</span> (;kk &lt; <a class="code" href="Random_8cpp.html#a0">N</a> - 1;kk++)
00084                 {
00085                         y = (mt[kk] &amp; <a class="code" href="Random_8cpp.html#a3">UPPER_MASK</a>) | (mt[kk + 1] &amp; <a class="code" href="Random_8cpp.html#a4">LOWER_MASK</a>);
00086                         mt[kk] = mt[kk + (<a class="code" href="Random_8cpp.html#a1">M</a> - <a class="code" href="Random_8cpp.html#a0">N</a>)] ^ (y &gt;&gt; 1) ^ mag01[y &amp; 0x1UL];
00087                 }
00088                 y = (mt[<a class="code" href="Random_8cpp.html#a0">N</a> - 1] &amp; <a class="code" href="Random_8cpp.html#a3">UPPER_MASK</a>) | (mt[0] &amp; <a class="code" href="Random_8cpp.html#a4">LOWER_MASK</a>);
00089                 mt[<a class="code" href="Random_8cpp.html#a0">N</a> - 1] = mt[<a class="code" href="Random_8cpp.html#a1">M</a> - 1] ^ (y &gt;&gt; 1) ^ mag01[y &amp; 0x1UL];
00090 
00091                 mti = 0;
00092         }
00093 
00094         y = mt[mti++];
00095 
00096         <span class="comment">/* Tempering */</span>
00097         y ^= (y &gt;&gt; 11);
00098         y ^= (y &lt;&lt; 7) &amp; 0x9d2c5680UL;
00099         y ^= (y &lt;&lt; 15) &amp; 0xefc60000UL;
00100         y ^= (y &gt;&gt; 18);
00101 
00102         <span class="keywordflow">return</span> y;
00103 }
00104 
00105 <span class="comment">/* generates a random real number on [0,1]-real-interval */</span>
<a name="l00106"></a><a class="code" href="namespacedg.html#a168">00106</a> <span class="keywordtype">float</span> <a class="code" href="namespacedg.html#a168">dg::RandomUnitReal</a>(<span class="keywordtype">void</span>)
00107 {
00108         <span class="keywordflow">return</span> <a class="code" href="namespacedg.html#a167">RandomInt</a>()*((float)1.0 / (float)4294967295.0);
00109         <span class="comment">/* divided by 2^32-1 */</span>
00110 }
00111 
00112 <span class="comment">/* generates a random real number on [0,1)-real-interval */</span>
<a name="l00113"></a><a class="code" href="namespacedg.html#a169">00113</a> <span class="keywordtype">float</span> <a class="code" href="namespacedg.html#a169">dg::RandomUnitOpenReal</a>(<span class="keywordtype">void</span>)
00114 {
00115         <span class="keywordflow">return</span> <a class="code" href="namespacedg.html#a167">RandomInt</a>()*((float)1.0 / (float)4294967296.0);
00116         <span class="comment">/* divided by 2^32 */</span>
00117 }
00118 
00119 <span class="comment">/******************************************************************************/</span>
00120 
</pre></div>		<div class="footer" width="100%">
		<hr>
			<a href="http://lyon-smith.org/">&copy; Derek Gerstmann - NCCA - Bournemouth University - 2004</a>
		</div>
		<br>
	</body>
</html>
