<html>
	<head>
		<title>Branch - API Documentation</title>
		<link HREF="style.css" REL="stylesheet" TYPE="text/css">
	</head>
	<body>
		<div width="100%" height="40px" class="banner">
			Visualizer - API Documentation
		</div>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>Matrix.cpp</h1><a href="Matrix_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">// start file: Matrix.cpp</span>
00002 
00003 <span class="comment">// #############################################################################</span>
00004 <span class="comment">// #</span>
00005 <span class="comment">// # Derek Gerstmann</span>
00006 <span class="comment">// # dgerstma@u.washington.edu</span>
00007 <span class="comment">// #</span>
00008 <span class="comment">// #############################################################################</span>
00009 
00010 <span class="comment">// headers</span>
00011 <span class="preprocessor">#include "<a class="code" href="Matrix_8h.html">Matrix.h</a>"</span>
00012 <span class="preprocessor">#include "<a class="code" href="DataTypes_8h.html">DataTypes.h</a>"</span>
00013 <span class="preprocessor">#include "<a class="code" href="Maths_8h.html">Maths.h</a>"</span>
00014 <span class="preprocessor">#include "<a class="code" href="Vector_8h.html">Vector.h</a>"</span>
00015 <span class="preprocessor">#include &lt;memory&gt;</span>
00016 <span class="preprocessor">#include &lt;algorithm&gt;</span>
00017 <span class="keyword">using</span> std::swap;
00018 
00020 <span class="comment">// Matrix implementation</span>
00022 <span class="comment"></span>
00023 <span class="keyword">using</span> <span class="keyword">namespace </span>dg;
00024 
00025 <span class="comment">//******************************************************************************</span>
<a name="l00026"></a><a class="code" href="classdg_1_1Matrix.html#a0">00026</a> Matrix::Matrix()
00027 {
00028         m_afV[0][1] = m_afV[0][2] = m_afV[0][3] =
00029         m_afV[1][0] = m_afV[1][2] = m_afV[1][3] =
00030         m_afV[2][0] = m_afV[2][1] = m_afV[2][3] =
00031         m_afV[3][0] = m_afV[3][1] = m_afV[3][2] = 0.0f;
00032         m_afV[0][0] = m_afV[1][1] = m_afV[2][2] = m_afV[3][3] = 1.0f;
00033 }       
00034 <span class="comment">//******************************************************************************</span>
00035 Matrix::Matrix(<a class="code" href="namespacedg.html#a28">Real</a> afV[16])
00036 {
00037         m_afV[0][0] = afV[0];
00038         m_afV[0][1] = afV[1];
00039         m_afV[0][2] = afV[2];
00040         m_afV[0][3] = afV[3];
00041         m_afV[1][0] = afV[4];
00042         m_afV[1][1] = afV[5];
00043         m_afV[1][2] = afV[6];
00044         m_afV[1][3] = afV[7];
00045         m_afV[2][0] = afV[8];
00046         m_afV[2][1] = afV[9];
00047         m_afV[2][2] = afV[10];
00048         m_afV[2][3] = afV[11];
00049         m_afV[3][0] = afV[12];
00050         m_afV[3][1] = afV[13];
00051         m_afV[3][2] = afV[14];
00052         m_afV[3][3] = afV[15];
00053 }
00054 <span class="comment">//******************************************************************************</span>
<a name="l00055"></a><a class="code" href="classdg_1_1Matrix.html#a1">00055</a> Matrix::Matrix(
00056         <a class="code" href="namespacedg.html#a28">Real</a> fV00, <a class="code" href="namespacedg.html#a28">Real</a> fV01, <a class="code" href="namespacedg.html#a28">Real</a> fV02, <a class="code" href="namespacedg.html#a28">Real</a> fV03,
00057         <a class="code" href="namespacedg.html#a28">Real</a> fV10, <a class="code" href="namespacedg.html#a28">Real</a> fV11, <a class="code" href="namespacedg.html#a28">Real</a> fV12, <a class="code" href="namespacedg.html#a28">Real</a> fV13,
00058         <a class="code" href="namespacedg.html#a28">Real</a> fV20, <a class="code" href="namespacedg.html#a28">Real</a> fV21, <a class="code" href="namespacedg.html#a28">Real</a> fV22, <a class="code" href="namespacedg.html#a28">Real</a> fV23,
00059         <a class="code" href="namespacedg.html#a28">Real</a> fV30, <a class="code" href="namespacedg.html#a28">Real</a> fV31, <a class="code" href="namespacedg.html#a28">Real</a> fV32, <a class="code" href="namespacedg.html#a28">Real</a> fV33)
00060 {
00061         m_afV[0][0] = fV00;
00062         m_afV[0][1] = fV01;
00063         m_afV[0][2] = fV02;
00064         m_afV[0][3] = fV03;
00065         m_afV[1][0] = fV10;
00066         m_afV[1][1] = fV11;
00067         m_afV[1][2] = fV12;
00068         m_afV[1][3] = fV13;
00069         m_afV[2][0] = fV20;
00070         m_afV[2][1] = fV21;
00071         m_afV[2][2] = fV22;
00072         m_afV[2][3] = fV23;
00073         m_afV[3][0] = fV30;
00074         m_afV[3][1] = fV31;
00075         m_afV[3][2] = fV32;
00076         m_afV[3][3] = fV33;
00077 }
00078 <span class="comment">//******************************************************************************</span>
<a name="l00079"></a><a class="code" href="classdg_1_1Matrix.html#a2">00079</a> Matrix::Matrix(<span class="keyword">const</span> <a class="code" href="namespacedg.html#a28">Real</a> afV[4][4])
00080 {
00081         m_afV[0][0] = afV[0][0];
00082         m_afV[0][1] = afV[0][1];
00083         m_afV[0][2] = afV[0][2];
00084         m_afV[0][3] = afV[0][3];
00085         m_afV[1][0] = afV[1][0];
00086         m_afV[1][1] = afV[1][1];
00087         m_afV[1][2] = afV[1][2];
00088         m_afV[1][3] = afV[1][3];
00089         m_afV[2][0] = afV[2][0];
00090         m_afV[2][1] = afV[2][1];
00091         m_afV[2][2] = afV[2][2];
00092         m_afV[2][3] = afV[2][3];
00093         m_afV[3][0] = afV[3][0];
00094         m_afV[3][1] = afV[3][1];
00095         m_afV[3][2] = afV[3][2];
00096         m_afV[3][3] = afV[3][3];
00097 }
00098 <span class="comment">//******************************************************************************</span>
<a name="l00099"></a><a class="code" href="classdg_1_1Matrix.html#a4">00099</a> Matrix::Matrix(<span class="keyword">const</span> <a class="code" href="classdg_1_1Vector.html">Vector</a> &amp;rkW, <span class="keyword">const</span> <a class="code" href="classdg_1_1Vector.html">Vector</a> &amp;rkV, <span class="keyword">const</span> <a class="code" href="classdg_1_1Vector.html">Vector</a> &amp;rkU)
00100 {
00101         m_afV[0][0] = rkW.<a class="code" href="classdg_1_1Vector.html#a2">x</a>(); m_afV[0][1] = rkW.<a class="code" href="classdg_1_1Vector.html#a3">y</a>(); m_afV[0][2] = rkW.<a class="code" href="classdg_1_1Vector.html#a4">z</a>();
00102         m_afV[1][0] = rkV.<a class="code" href="classdg_1_1Vector.html#a2">x</a>(); m_afV[1][1] = rkV.<a class="code" href="classdg_1_1Vector.html#a3">y</a>(); m_afV[1][2] = rkV.<a class="code" href="classdg_1_1Vector.html#a4">z</a>();
00103         m_afV[2][0] = rkU.<a class="code" href="classdg_1_1Vector.html#a2">x</a>(); m_afV[2][1] = rkU.<a class="code" href="classdg_1_1Vector.html#a3">y</a>(); m_afV[2][2] = rkU.<a class="code" href="classdg_1_1Vector.html#a4">z</a>();
00104 
00105         m_afV[0][3] = m_afV[1][3] = m_afV[2][3] = 0;
00106         m_afV[3][0] = m_afV[3][1] = m_afV[3][2] = 0;
00107         m_afV[3][3] = 1.0;
00108 }
00109 <span class="comment">//******************************************************************************</span>
00110 <span class="comment">/*</span>
00111 <span class="comment">Matrix::Matrix(const Matrix&amp; rkMatrix)</span>
00112 <span class="comment">{</span>
00113 <span class="comment">        m_afV[0][0] = rkMatrix.m_afV[0][0];</span>
00114 <span class="comment">        m_afV[0][1] = rkMatrix.m_afV[0][1];</span>
00115 <span class="comment">        m_afV[0][2] = rkMatrix.m_afV[0][2];</span>
00116 <span class="comment">        m_afV[0][3] = rkMatrix.m_afV[0][3];</span>
00117 <span class="comment">        m_afV[1][0] = rkMatrix.m_afV[1][0];</span>
00118 <span class="comment">        m_afV[1][1] = rkMatrix.m_afV[1][1];</span>
00119 <span class="comment">        m_afV[1][2] = rkMatrix.m_afV[1][2];</span>
00120 <span class="comment">        m_afV[1][3] = rkMatrix.m_afV[1][3];</span>
00121 <span class="comment">        m_afV[2][0] = rkMatrix.m_afV[2][0];</span>
00122 <span class="comment">        m_afV[2][1] = rkMatrix.m_afV[2][1];</span>
00123 <span class="comment">        m_afV[2][2] = rkMatrix.m_afV[2][2];</span>
00124 <span class="comment">        m_afV[2][3] = rkMatrix.m_afV[2][3];</span>
00125 <span class="comment">        m_afV[3][0] = rkMatrix.m_afV[3][0];</span>
00126 <span class="comment">        m_afV[3][1] = rkMatrix.m_afV[3][1];</span>
00127 <span class="comment">        m_afV[3][2] = rkMatrix.m_afV[3][2];</span>
00128 <span class="comment">        m_afV[3][3] = rkMatrix.m_afV[3][3];</span>
00129 <span class="comment">}</span>
00130 <span class="comment">*/</span>
00131 <span class="comment">//******************************************************************************</span>
<a name="l00132"></a><a class="code" href="classdg_1_1Matrix.html#a12">00132</a> <span class="keywordtype">void</span> Matrix::getRow( <a class="code" href="namespacedg.html#a15">UInt</a> uiRow, <a class="code" href="classdg_1_1Vector.html">Vector</a> &amp; rkV )<span class="keyword"> const</span>
00133 <span class="keyword"></span>{
00134         rkV = <a class="code" href="classdg_1_1Vector.html">Vector</a>( 
00135                         m_afV[ 0 ] [ uiRow ], 
00136                         m_afV[ 1 ] [ uiRow ], 
00137                         m_afV[ 2 ] [ uiRow ] );
00138 }
00139 <span class="comment">//******************************************************************************</span>
<a name="l00140"></a><a class="code" href="classdg_1_1Matrix.html#a13">00140</a> <span class="keywordtype">void</span> Matrix::getColumn( <a class="code" href="namespacedg.html#a15">UInt</a> uiCol, <a class="code" href="classdg_1_1Vector.html">Vector</a> &amp; rkV )<span class="keyword"> const</span>
00141 <span class="keyword"></span>{
00142         rkV = <a class="code" href="classdg_1_1Vector.html">Vector</a>( 
00143                         m_afV[ uiCol ] [ 0 ], 
00144                         m_afV[ uiCol ] [ 1 ], 
00145                         m_afV[ uiCol ] [ 2 ] );
00146 }
00147 <span class="comment">//******************************************************************************</span>
<a name="l00148"></a><a class="code" href="classdg_1_1Matrix.html#a14">00148</a> <span class="keywordtype">void</span> Matrix::getTranspose( <a class="code" href="classdg_1_1Matrix.html">Matrix</a> &amp; rkM )<span class="keyword"> const</span>
00149 <span class="keyword"></span>{
00150         <span class="keywordflow">for</span> ( <a class="code" href="namespacedg.html#a15">UInt</a> iRow = 0; iRow &lt; 4; iRow++ )
00151                 <span class="keywordflow">for</span> ( <a class="code" href="namespacedg.html#a15">UInt</a> iCol = 0; iCol &lt; 4; iCol++ )
00152                         rkM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ iCol ] [ iRow ] = m_afV[ iRow ] [ iCol ];
00153 }
00154 <span class="comment">//******************************************************************************</span>
<a name="l00155"></a><a class="code" href="classdg_1_1Matrix.html#a27">00155</a> <span class="keywordtype">void</span> Matrix::transpose()
00156 {
00157         <span class="keywordflow">for</span> ( <a class="code" href="namespacedg.html#a15">UInt</a> iRow = 0; iRow &lt; 4; iRow++ )
00158                 <span class="keywordflow">for</span> ( <a class="code" href="namespacedg.html#a15">UInt</a> iCol = 0; iCol &lt; 4; iCol++ )
00159                         m_afV[ iCol ] [ iRow ] = m_afV[ iRow ] [ iCol ];
00160 }
00161 <span class="comment">//******************************************************************************</span>
<a name="l00162"></a><a class="code" href="classdg_1_1Matrix.html#a30">00162</a> <a class="code" href="classdg_1_1Matrix.html">Matrix</a> Matrix::inverse()<span class="keyword"> const</span>
00163 <span class="keyword"></span>{
00164         <a class="code" href="namespacedg.html#a15">UInt</a> auiXCol[ 4 ], auiXRow[ 4 ];
00165         <a class="code" href="namespacedg.html#a15">UInt</a> auiPivot[ 4 ] = { 0, 0, 0, 0 };
00166 
00167         <a class="code" href="namespacedg.html#a28">Real</a> afMInv[ 4 ][ 4 ];
00168         memcpy( afMInv, m_afV, 4 * 4 * <span class="keyword">sizeof</span>( <a class="code" href="namespacedg.html#a28">Real</a> ) );
00169 
00170         <span class="keywordflow">for</span> ( <a class="code" href="namespacedg.html#a15">UInt</a> i = 0; i &lt; 4; i++ )
00171         {
00172                 <a class="code" href="namespacedg.html#a14">Int</a> iRow = -1, iCol = -1;
00173                 <a class="code" href="namespacedg.html#a28">Real</a> big = 0.;
00174         
00175                 <span class="comment">// choose pivot</span>
00176                 <span class="keywordflow">for</span> ( <a class="code" href="namespacedg.html#a15">UInt</a> j = 0; j &lt; 4; j++ )
00177                 {
00178                         <span class="keywordflow">if</span> ( auiPivot[ j ] != 1 )
00179                         {
00180                                 <span class="keywordflow">for</span> ( <a class="code" href="namespacedg.html#a15">UInt</a> k = 0; k &lt; 4; k++ )
00181                                 {
00182                                         <span class="keywordflow">if</span> ( auiPivot[ k ] == 0 )
00183                                         {
00184                                                 <span class="keywordflow">if</span> ( fabsf( afMInv[ j ][ k ] ) &gt;= big )
00185                                                 {
00186                                                         big = <a class="code" href="namespacedg.html#a28">Real</a>( <a class="code" href="namespacedg.html#a90">Abs</a>( afMInv[ j ][ k ] ) );
00187                                                         iRow = j;
00188                                                         iCol = k;
00189                                                 }
00190                                         }
00191                                         <span class="keywordflow">else</span>
00192                                                 <span class="keywordflow">if</span> ( auiPivot[ k ] &gt; 1 )
00193                                                         <span class="keywordflow">return</span> <a class="code" href="classdg_1_1Matrix.html#a0">Matrix</a>();
00194                                                         <span class="comment">//Error( "Singular matrix in MatrixInvert" );</span>
00195                                 }
00196                         }
00197                 }
00198                 ++auiPivot[ iCol ];
00199                 
00200                 <span class="comment">// Swap rows _iRow_ and _iCol_ for pivot</span>
00201                 <span class="keywordflow">if</span> ( iRow != iCol )
00202                 {
00203                         <span class="keywordflow">for</span> ( <a class="code" href="namespacedg.html#a15">UInt</a> k = 0; k &lt; 4; ++k )
00204                                 swap( afMInv[ iRow ][ k ], afMInv[ iCol ][ k ] );
00205                 }
00206                 auiXRow[ i ] = iRow;
00207                 auiXCol[ i ] = iCol;
00208                 
00209                 <span class="keywordflow">if</span> ( afMInv[ iCol ][ iCol ] == 0. )
00210                         <span class="keywordflow">return</span> <a class="code" href="classdg_1_1Matrix.html#a0">Matrix</a>();
00211                         <span class="comment">//Error( "Singular matrix in MatrixInvert" );</span>
00212                 
00213                 <span class="comment">// Set $m[iCol][iCol]$ to one by scaling row _iCol_ appropriately</span>
00214                 <a class="code" href="namespacedg.html#a28">Real</a> fPivotInv = 1.f / afMInv[ iCol ][ iCol ];
00215                 afMInv[ iCol ][ iCol ] = 1.f;
00216                 <span class="keywordflow">for</span> ( <a class="code" href="namespacedg.html#a15">UInt</a> j = 0; j &lt; 4; j++ )
00217                         afMInv[ iCol ][ j ] *= fPivotInv;
00218                 
00219                 <span class="comment">// Subtract this row from others to zero out their columns</span>
00220                 <span class="keywordflow">for</span> ( <a class="code" href="namespacedg.html#a14">Int</a> j = 0; j &lt; 4; j++ )
00221                 {
00222                         <span class="keywordflow">if</span> ( j != iCol )
00223                         {
00224                                 <a class="code" href="namespacedg.html#a28">Real</a> fSave = afMInv[ j ][ iCol ];
00225                                 afMInv[ j ][ iCol ] = 0;
00226                                 <span class="keywordflow">for</span> ( <a class="code" href="namespacedg.html#a15">UInt</a> k = 0; k &lt; 4; k++ )
00227                                         afMInv[ j ][ k ] -= afMInv[ iCol ][ k ] * fSave;
00228                         }
00229                 }
00230         }
00231         
00232         <span class="comment">// Swap columns to reflect permutation</span>
00233         <span class="keywordflow">for</span> ( <a class="code" href="namespacedg.html#a14">Int</a> j = 3; j &gt;= 0; j-- )
00234         {
00235                 <span class="keywordflow">if</span> ( auiXRow[ j ] != auiXCol[ j ] )
00236                 {
00237                         <span class="keywordflow">for</span> ( <a class="code" href="namespacedg.html#a15">UInt</a> k = 0; k &lt; 4; k++ )
00238                                 swap( afMInv[ k ][ auiXRow[ j ] ], 
00239                                       afMInv[ k ][ auiXCol[ j ] ] );
00240                 }
00241         }
00242         <span class="keywordflow">return</span> <a class="code" href="classdg_1_1Matrix.html#a0">Matrix</a>( afMInv );
00243 
00244 }
00245 <span class="comment">//******************************************************************************</span>
<a name="l00246"></a><a class="code" href="classdg_1_1Matrix.html#a23">00246</a> <a class="code" href="classdg_1_1Matrix.html">Matrix</a>&amp; Matrix::operator *= ( <span class="keyword">const</span> <a class="code" href="classdg_1_1Matrix.html">Matrix</a> &amp; rkM )
00247 {
00248         <a class="code" href="namespacedg.html#a15">UInt</a> iRow, iCol, iPlace;
00249 
00250         <span class="keywordflow">for</span> ( iRow = 0; iRow &lt; 4; iRow++ )
00251         {
00252                 <span class="keywordflow">for</span> ( iCol = 0; iCol &lt; 4; iCol++ )
00253                 {
00254                         m_afV[ iRow ] [ iCol ] = 0.0;
00255                         <span class="keywordflow">for</span> ( iPlace = 0; iPlace &lt; 4; iPlace++ )
00256                         {
00257                                 m_afV[ iRow ] [ iCol ] += m_afV[ iRow ] [ iPlace ] * 
00258                                                                                   rkM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ iPlace ] [ iCol ];
00259                         }
00260                 }
00261         }
00262         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00263 }
00264 <span class="comment">//******************************************************************************</span>
<a name="l00265"></a><a class="code" href="classdg_1_1Matrix.html#a15">00265</a> <a class="code" href="classdg_1_1Matrix.html">Matrix</a> Matrix::operator+( <span class="keyword">const</span> <a class="code" href="classdg_1_1Matrix.html">Matrix</a>&amp; rkM )<span class="keyword"> const</span>
00266 <span class="keyword"></span>{
00267         <a class="code" href="classdg_1_1Matrix.html">Matrix</a> kRet;
00268         <a class="code" href="namespacedg.html#a15">UInt</a> iRow, iCol;
00269         <span class="keywordflow">for</span> ( iRow = 0; iRow &lt; 4; iRow++ )
00270         {
00271                 <span class="keywordflow">for</span> ( iCol = 0; iCol &lt; 4; iCol++ )
00272                 {
00273                         kRet.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ iRow ][ iCol ] = m_afV[ iRow ][ iCol ] + 
00274                                                                                  rkM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ iRow ][ iCol ];
00275                 }
00276         }
00277         <span class="keywordflow">return</span> kRet;
00278 }
00279 <span class="comment">//******************************************************************************</span>
<a name="l00280"></a><a class="code" href="classdg_1_1Matrix.html#a16">00280</a> <a class="code" href="classdg_1_1Matrix.html">Matrix</a> Matrix::operator-( <span class="keyword">const</span> <a class="code" href="classdg_1_1Matrix.html">Matrix</a>&amp; rkM )<span class="keyword"> const</span>
00281 <span class="keyword"></span>{
00282         <a class="code" href="classdg_1_1Matrix.html">Matrix</a> kRet;
00283         <a class="code" href="namespacedg.html#a15">UInt</a> iRow, iCol;
00284         <span class="keywordflow">for</span> ( iRow = 0; iRow &lt; 4; iRow++ )
00285         {
00286                 <span class="keywordflow">for</span> ( iCol = 0; iCol &lt; 4; iCol++ )
00287                 {
00288                         kRet.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ iRow ][ iCol ] = m_afV[ iRow ][ iCol ] - 
00289                                                                                  rkM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ iRow ][ iCol ];
00290                 }
00291         }
00292         <span class="keywordflow">return</span> kRet;
00293 }
00294 <span class="comment">//******************************************************************************</span>
<a name="l00295"></a><a class="code" href="classdg_1_1Matrix.html#a17">00295</a> <a class="code" href="classdg_1_1Matrix.html">Matrix</a> Matrix::operator * ( <span class="keyword">const</span> <a class="code" href="classdg_1_1Matrix.html">Matrix</a> &amp; rkM )<span class="keyword"> const</span>
00296 <span class="keyword"></span>{
00297         <a class="code" href="namespacedg.html#a15">UInt</a> iRow, iCol, iPlace;
00298         <span class="keyword">static</span> <a class="code" href="classdg_1_1Matrix.html">Matrix</a> kM;
00299 
00300         <span class="keywordflow">for</span> ( iRow = 0; iRow &lt; 4; iRow++ )
00301         {
00302                 <span class="keywordflow">for</span> ( iCol = 0; iCol &lt; 4; iCol++ )
00303                 {
00304                         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ iRow ] [ iCol ] = 0.0;
00305                         <span class="keywordflow">for</span> ( iPlace = 0; iPlace &lt; 4; iPlace++ )
00306                         {
00307                                 kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ iRow ] [ iCol ] += m_afV[ iRow ] [ iPlace ] * 
00308                                                                                          rkM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ iPlace ] [ iCol ];
00309                         }
00310                 }
00311         }
00312 
00313         <span class="keywordflow">return</span> kM;
00314 }
00315 <span class="comment">//******************************************************************************</span>
<a name="l00316"></a><a class="code" href="classdg_1_1Matrix.html#a21">00316</a> <a class="code" href="classdg_1_1Matrix.html">Matrix</a>&amp; Matrix::operator+=( <span class="keyword">const</span> <a class="code" href="classdg_1_1Matrix.html">Matrix</a> &amp;rkM )
00317 {
00318         <a class="code" href="namespacedg.html#a15">UInt</a> iRow, iCol;
00319         <span class="keywordflow">for</span> ( iRow = 0; iRow &lt; 4; iRow++ )
00320         {
00321                 <span class="keywordflow">for</span> ( iCol = 0; iCol &lt; 4; iCol++ )
00322                 {
00323                         m_afV[ iRow ][ iCol ] += rkM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ iRow ][ iCol ];
00324                 }
00325         }
00326         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00327 }
00328 <span class="comment">//******************************************************************************</span>
<a name="l00329"></a><a class="code" href="classdg_1_1Matrix.html#a22">00329</a> <a class="code" href="classdg_1_1Matrix.html">Matrix</a>&amp; Matrix::operator-=( <span class="keyword">const</span> <a class="code" href="classdg_1_1Matrix.html">Matrix</a> &amp;rkM )
00330 {
00331         <a class="code" href="namespacedg.html#a15">UInt</a> iRow, iCol;
00332         <span class="keywordflow">for</span> ( iRow = 0; iRow &lt; 4; iRow++ )
00333         {
00334                 <span class="keywordflow">for</span> ( iCol = 0; iCol &lt; 4; iCol++ )
00335                 {
00336                         m_afV[ iRow ][ iCol ] -= rkM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ iRow ][ iCol ];
00337                 }
00338         }
00339         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00340 }
00341 <span class="comment">//******************************************************************************</span>
<a name="l00342"></a><a class="code" href="classdg_1_1Matrix.html#a18">00342</a> <a class="code" href="classdg_1_1Matrix.html">Matrix</a> Matrix::operator * ( <a class="code" href="namespacedg.html#a28">Real</a> fC )<span class="keyword"> const</span>
00343 <span class="keyword"></span>{
00344 
00345         <span class="keyword">static</span> <a class="code" href="classdg_1_1Matrix.html">Matrix</a> kM;
00346 
00347         <span class="keywordflow">for</span> ( <a class="code" href="namespacedg.html#a15">UInt</a> iRow = 0; iRow &lt; 4; iRow++ )
00348                 <span class="keywordflow">for</span> ( <a class="code" href="namespacedg.html#a15">UInt</a> iCol = 0; iCol &lt; 4; iCol++ )
00349                         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ iCol ] [ iRow ] = m_afV[ iRow ] [ iCol ] * fC;
00350 
00351         <span class="keywordflow">return</span> kM;
00352 }
00353 <span class="comment">//******************************************************************************</span>
<a name="l00354"></a><a class="code" href="classdg_1_1Matrix.html#a19">00354</a> <a class="code" href="classdg_1_1Matrix.html">Matrix</a> Matrix::operator / ( <a class="code" href="namespacedg.html#a28">Real</a> fC )<span class="keyword"> const</span>
00355 <span class="keyword"></span>{
00356         <a class="code" href="namespacedg.html#a15">UInt</a> iRow, iCol;
00357         <span class="keyword">static</span> <a class="code" href="classdg_1_1Matrix.html">Matrix</a> kM;
00358         
00359         <span class="keywordflow">if</span>( fC == (Real)0.0f )
00360         {
00361                 <span class="keywordflow">for</span> ( iRow = 0; iRow &lt; 4; iRow++ )
00362                 {
00363                         <span class="keywordflow">for</span> ( iCol = 0; iCol &lt; 4; iCol++ )
00364                         {
00365                                 kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ iRow ] [ iCol ] = INFINITY;
00366                         }
00367                 }               
00368         }
00369         <span class="keywordflow">else</span>
00370         {
00371         <a class="code" href="namespacedg.html#a28">Real</a> fInvC = ((Real)1.0)/fC;
00372                 <span class="keywordflow">for</span> ( <a class="code" href="namespacedg.html#a15">UInt</a> iRow = 0; iRow &lt; 4; iRow++ )
00373                         <span class="keywordflow">for</span> ( <a class="code" href="namespacedg.html#a15">UInt</a> iCol = 0; iCol &lt; 4; iCol++ )
00374                                 kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ iCol ] [ iRow ] = m_afV[ iRow ] [ iCol ] * fInvC;
00375         }
00376 
00377         <span class="keywordflow">return</span> kM;
00378 }
00379 <span class="comment">//******************************************************************************</span>
<a name="l00380"></a><a class="code" href="classdg_1_1Matrix.html#a26">00380</a> <a class="code" href="classdg_1_1Vector.html">Vector</a> Matrix::operator * ( <span class="keyword">const</span> <a class="code" href="classdg_1_1Vector.html">Vector</a> &amp; rkV )<span class="keyword"> const</span>
00381 <span class="keyword"></span>{
00382         <a class="code" href="classdg_1_1Vector.html">Vector</a> kV(
00383         
00384             (   m_afV[ 0 ] [ 0 ] * rkV.<a class="code" href="classdg_1_1Vector.html#a2">x</a>() + 
00385                         m_afV[ 1 ] [ 0 ] * rkV.<a class="code" href="classdg_1_1Vector.html#a3">y</a>() + 
00386                         m_afV[ 2 ] [ 0 ] * rkV.<a class="code" href="classdg_1_1Vector.html#a4">z</a>() + 
00387                         m_afV[ 3 ] [ 0 ] ),
00388                         
00389             (   m_afV[ 0 ] [ 1 ] * rkV.<a class="code" href="classdg_1_1Vector.html#a2">x</a>() + 
00390                         m_afV[ 1 ] [ 1 ] * rkV.<a class="code" href="classdg_1_1Vector.html#a3">y</a>() + 
00391                         m_afV[ 2 ] [ 1 ] * rkV.<a class="code" href="classdg_1_1Vector.html#a4">z</a>() + 
00392                         m_afV[ 3 ] [ 1 ] ),
00393                         
00394             (   m_afV[ 0 ] [ 2 ] * rkV.<a class="code" href="classdg_1_1Vector.html#a2">x</a>() + 
00395                         m_afV[ 1 ] [ 2 ] * rkV.<a class="code" href="classdg_1_1Vector.html#a3">y</a>() + 
00396                         m_afV[ 2 ] [ 2 ] * rkV.<a class="code" href="classdg_1_1Vector.html#a4">z</a>() + 
00397                         m_afV[ 3 ] [ 2 ] )
00398         );
00399         <span class="keywordflow">return</span> ( kV );
00400 }
00401 <span class="comment">//******************************************************************************</span>
<a name="l00402"></a><a class="code" href="classdg_1_1Matrix.html#d4">00402</a> <a class="code" href="classdg_1_1Matrix.html">Matrix</a> Matrix::buildRotation( <span class="keyword">const</span> <a class="code" href="classdg_1_1Vector.html">Vector</a> &amp; rkFrom, <span class="keyword">const</span> <a class="code" href="classdg_1_1Vector.html">Vector</a> &amp; rkTo )
00403 {
00404         <span class="comment">// compute dot product between From and To</span>
00405         <a class="code" href="namespacedg.html#a28">Real</a> fCosAngle = rkFrom.<a class="code" href="classdg_1_1Vector.html#a35">dot</a>( rkTo );
00406 
00407         <a class="code" href="namespacedg.html#a28">Real</a> fEpsilon = 10e-4;
00408         <span class="keywordflow">if</span> ( <a class="code" href="namespacedg.html#a90">Abs</a>( fCosAngle - 1 ) &lt; fEpsilon )  
00409         {
00410                 <span class="comment">// rotate by an angle of zero with an arbitrary direction</span>
00411                 <span class="keywordflow">return</span> <a class="code" href="classdg_1_1Matrix.html#d2">buildRotation</a>( 0.0, 1 ); <span class="comment">// use y axis</span>
00412         }
00413         <span class="keywordflow">else</span>
00414                 <span class="keywordflow">if</span> ( <a class="code" href="namespacedg.html#a90">Abs</a>( fCosAngle + 1.0 ) &lt; fEpsilon )        <span class="comment">// dot product close to 0.0</span>
00415                 {
00416                         <span class="comment">// find an orthogonal direction to create axis</span>
00417                         <a class="code" href="classdg_1_1Vector.html">Vector</a> kOrtho;
00418 
00419                         <span class="keywordflow">if</span> ( <a class="code" href="namespacedg.html#a90">Abs</a>( rkFrom.<a class="code" href="classdg_1_1Vector.html#a2">x</a>() ) &lt; <a class="code" href="namespacedg.html#a90">Abs</a>( rkFrom.<a class="code" href="classdg_1_1Vector.html#a3">y</a>() ) )
00420                         {
00421                                 <span class="keywordflow">if</span> ( <a class="code" href="namespacedg.html#a90">Abs</a>( rkFrom.<a class="code" href="classdg_1_1Vector.html#a2">x</a>() ) &lt; <a class="code" href="namespacedg.html#a90">Abs</a>( rkFrom.<a class="code" href="classdg_1_1Vector.html#a4">z</a>() ) )
00422                                 {
00423                                         kOrtho = <a class="code" href="classdg_1_1Vector.html">Vector</a>( 1.0, 0.0, 0.0 );       <span class="comment">// use x axis.</span>
00424                                 }
00425                                 <span class="keywordflow">else</span>
00426                                 {
00427                                         kOrtho = <a class="code" href="classdg_1_1Vector.html">Vector</a>( 0.0, 0.0, 1.0 );       <span class="comment">// use z axis</span>
00428                                 }
00429                         }
00430                         <span class="keywordflow">else</span>
00431                                 <span class="keywordflow">if</span> ( <a class="code" href="namespacedg.html#a90">Abs</a>( rkFrom.<a class="code" href="classdg_1_1Vector.html#a3">y</a>() ) &lt; <a class="code" href="namespacedg.html#a90">Abs</a>( rkFrom.<a class="code" href="classdg_1_1Vector.html#a4">z</a>() ) )
00432                                 {
00433                                         kOrtho = <a class="code" href="classdg_1_1Vector.html">Vector</a>( 0.0, 1.0, 0.0 );       <span class="comment">// use y axis</span>
00434                                 }
00435                                 <span class="keywordflow">else</span>
00436                                 {
00437                                         kOrtho = <a class="code" href="classdg_1_1Vector.html">Vector</a>( 0.0, 0.0, 1.0 );       <span class="comment">// use z axis</span>
00438                                 }
00439 
00440                         <span class="comment">// find orthogonal axis to use for rotation</span>
00441                         <a class="code" href="classdg_1_1Vector.html">Vector</a> kAxis( rkFrom.<a class="code" href="classdg_1_1Vector.html#a36">cross</a>( kOrtho ) ); <span class="comment">// Axis = From x Ortho (cross prod)</span>
00442                         kAxis.<a class="code" href="classdg_1_1Vector.html#a34">normalize</a>();
00443 
00444                         <a class="code" href="namespacedg.html#a28">Real</a> fAngle = <a class="code" href="namespacedg.html#a111">ArcCosine</a>( fCosAngle );   <span class="comment">// find rotation angle</span>
00445 
00446                         <span class="comment">// create new rotation matrix about new axis</span>
00447                         <span class="keywordflow">return</span> <a class="code" href="classdg_1_1Matrix.html#d2">buildRotation</a>( fAngle, kAxis );
00448                 }
00449                 <span class="keywordflow">else</span>
00450                 {
00451                         <span class="comment">// find orthogonal axis to use for rotation</span>
00452                         <a class="code" href="classdg_1_1Vector.html">Vector</a> kAxis( rkFrom.<a class="code" href="classdg_1_1Vector.html#a36">cross</a>( rkTo ) );   <span class="comment">// Axis = From x To (cross prod)</span>
00453                         <a class="code" href="namespacedg.html#a28">Real</a> fAngle = <a class="code" href="namespacedg.html#a111">ArcCosine</a>( fCosAngle );   <span class="comment">// find rotation angle</span>
00454 
00455                         <span class="comment">// create new rotation matrix about new axis</span>
00456                         <span class="keywordflow">return</span> <a class="code" href="classdg_1_1Matrix.html#d2">buildRotation</a>( fAngle, kAxis );
00457                 }
00458 }
00459 <span class="comment">//******************************************************************************</span>
<a name="l00460"></a><a class="code" href="classdg_1_1Matrix.html#d8">00460</a> <a class="code" href="classdg_1_1Matrix.html">Matrix</a> Matrix::buildTransform( <span class="keyword">const</span> <a class="code" href="classdg_1_1Vector.html">Vector</a> &amp; rkT, <span class="keyword">const</span> <a class="code" href="classdg_1_1Matrix.html">Matrix</a> &amp; rkR, <span class="keyword">const</span> <a class="code" href="classdg_1_1Vector.html">Vector</a> &amp; rkS )
00461 {
00462         <a class="code" href="classdg_1_1Matrix.html">Matrix</a> kT(
00463             rkS.<a class="code" href="classdg_1_1Vector.html#a2">x</a>() * rkR.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 0 ] [ 0 ], rkS.<a class="code" href="classdg_1_1Vector.html#a3">y</a>() * rkR.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 0 ] [ 1 ],
00464             rkS.<a class="code" href="classdg_1_1Vector.html#a4">z</a>() * rkR.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 0 ] [ 2 ], 0.0f,
00465             rkS.<a class="code" href="classdg_1_1Vector.html#a2">x</a>() * rkR.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 1 ] [ 0 ], rkS.<a class="code" href="classdg_1_1Vector.html#a3">y</a>() * rkR.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 1 ] [ 1 ],
00466             rkS.<a class="code" href="classdg_1_1Vector.html#a4">z</a>() * rkR.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 1 ] [ 2 ], 0.0f,
00467             rkS.<a class="code" href="classdg_1_1Vector.html#a2">x</a>() * rkR.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 2 ] [ 0 ], rkS.<a class="code" href="classdg_1_1Vector.html#a3">y</a>() * rkR.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 2 ] [ 1 ],
00468             rkS.<a class="code" href="classdg_1_1Vector.html#a4">z</a>() * rkR.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 2 ] [ 2 ], 0.0f,
00469             rkT.<a class="code" href="classdg_1_1Vector.html#a2">x</a>(), rkT.<a class="code" href="classdg_1_1Vector.html#a3">y</a>(), rkT.<a class="code" href="classdg_1_1Vector.html#a4">z</a>(), 1.0f );
00470 
00471         <span class="keywordflow">return</span> kT;
00472 }
00473 <span class="comment">//******************************************************************************</span>
<a name="l00474"></a><a class="code" href="classdg_1_1Matrix.html#d0">00474</a> <a class="code" href="classdg_1_1Matrix.html">Matrix</a> Matrix::buildIdentity()
00475 {
00476         <a class="code" href="classdg_1_1Matrix.html">Matrix</a> kM(
00477             1.0, 0.0, 0.0, 0.0,
00478             0.0, 1.0, 0.0, 0.0,
00479             0.0, 0.0, 1.0, 0.0,
00480             0.0, 0.0, 0.0, 1.0 );
00481         <span class="keywordflow">return</span> kM;
00482 }
00483 <span class="comment">//******************************************************************************</span>
<a name="l00484"></a><a class="code" href="classdg_1_1Matrix.html#d1">00484</a> <a class="code" href="classdg_1_1Matrix.html">Matrix</a> Matrix::buildScale( <span class="keyword">const</span> <a class="code" href="classdg_1_1Vector.html">Vector</a> &amp; rkV )
00485 {
00486         <a class="code" href="classdg_1_1Matrix.html">Matrix</a> kM;
00487         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 0 ] [ 0 ] = rkV.<a class="code" href="classdg_1_1Vector.html#a2">x</a>();
00488         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 1 ] [ 1 ] = rkV.<a class="code" href="classdg_1_1Vector.html#a3">y</a>();
00489         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 2 ] [ 2 ] = rkV.<a class="code" href="classdg_1_1Vector.html#a4">z</a>();
00490         <span class="keywordflow">return</span> kM;
00491 }
00492 <span class="comment">//******************************************************************************</span>
<a name="l00493"></a><a class="code" href="classdg_1_1Matrix.html#d7">00493</a> <a class="code" href="classdg_1_1Matrix.html">Matrix</a> Matrix::buildTranslation( <span class="keyword">const</span> <a class="code" href="classdg_1_1Vector.html">Vector</a> &amp; rkV )
00494 {
00495         <a class="code" href="classdg_1_1Matrix.html">Matrix</a> kM;
00496         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 0 ] [ 3 ] = rkV.<a class="code" href="classdg_1_1Vector.html#a2">x</a>();
00497         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 1 ] [ 3 ] = rkV.<a class="code" href="classdg_1_1Vector.html#a3">y</a>();
00498         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 2 ] [ 3 ] = rkV.<a class="code" href="classdg_1_1Vector.html#a4">z</a>();
00499         <span class="keywordflow">return</span> kM;
00500 }
00501 <span class="comment">//******************************************************************************</span>
<a name="l00502"></a><a class="code" href="classdg_1_1Matrix.html#d3">00502</a> <a class="code" href="classdg_1_1Matrix.html">Matrix</a> Matrix::buildRotation( <a class="code" href="namespacedg.html#a28">Real</a> fX, <a class="code" href="namespacedg.html#a28">Real</a> fY, <a class="code" href="namespacedg.html#a28">Real</a> fZ )
00503 {
00504         <a class="code" href="classdg_1_1Matrix.html">Matrix</a> kX = <a class="code" href="classdg_1_1Matrix.html#d2">buildRotation</a>( fX, 0 );
00505         <a class="code" href="classdg_1_1Matrix.html">Matrix</a> kY = <a class="code" href="classdg_1_1Matrix.html#d2">buildRotation</a>( fY, 1 );
00506         <a class="code" href="classdg_1_1Matrix.html">Matrix</a> kZ = <a class="code" href="classdg_1_1Matrix.html#d2">buildRotation</a>( fZ, 2 );
00507 
00508         <span class="keywordflow">return</span> kZ * ( kY * kX );
00509 }
00510 <span class="comment">//******************************************************************************</span>
<a name="l00511"></a><a class="code" href="classdg_1_1Matrix.html#d5">00511</a> <a class="code" href="classdg_1_1Matrix.html">Matrix</a> Matrix::buildRotation( <span class="keyword">const</span> <a class="code" href="classdg_1_1Vector.html">Vector</a> &amp; rkV )
00512 {
00513         <a class="code" href="classdg_1_1Matrix.html">Matrix</a> kX = <a class="code" href="classdg_1_1Matrix.html#d2">buildRotation</a>( rkV.<a class="code" href="classdg_1_1Vector.html#a2">x</a>(), 0 ); 
00514         <a class="code" href="classdg_1_1Matrix.html">Matrix</a> kY = <a class="code" href="classdg_1_1Matrix.html#d2">buildRotation</a>( rkV.<a class="code" href="classdg_1_1Vector.html#a3">y</a>(), 1 ); 
00515         <a class="code" href="classdg_1_1Matrix.html">Matrix</a> kZ = <a class="code" href="classdg_1_1Matrix.html#d2">buildRotation</a>( rkV.<a class="code" href="classdg_1_1Vector.html#a4">z</a>(), 2 ); 
00516 
00517         <span class="keywordflow">return</span> kZ * ( kY * kX );
00518 }
00519 <span class="comment">//******************************************************************************</span>
<a name="l00520"></a><a class="code" href="classdg_1_1Matrix.html#d2">00520</a> <a class="code" href="classdg_1_1Matrix.html">Matrix</a> Matrix::buildRotation( <a class="code" href="namespacedg.html#a28">Real</a> fA, <a class="code" href="classdg_1_1Vector.html">Vector</a> &amp; rkDir )
00521 {
00522         rkDir.<a class="code" href="classdg_1_1Vector.html#a34">normalize</a>();
00523 
00524         <span class="comment">//      dA *= -M_PI_OVER_180;</span>
00525         fA = <a class="code" href="namespacedg.html#a88">Radians</a>( fA );
00526         <a class="code" href="namespacedg.html#a28">Real</a> fCos = <a class="code" href="namespacedg.html#a115">Cosine</a>( fA );
00527         <a class="code" href="namespacedg.html#a28">Real</a> fSin = <a class="code" href="namespacedg.html#a115">Cosine</a>( fA );
00528 
00529         <a class="code" href="classdg_1_1Matrix.html">Matrix</a> kM;
00530         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 0 ] [ 0 ] = ( rkDir.<a class="code" href="classdg_1_1Vector.html#a2">x</a>() * rkDir.<a class="code" href="classdg_1_1Vector.html#a2">x</a>() ) * 
00531                                                   ( 1.0 - fCos ) + fCos;
00532         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 0 ] [ 1 ] = ( rkDir.<a class="code" href="classdg_1_1Vector.html#a2">x</a>() * rkDir.<a class="code" href="classdg_1_1Vector.html#a3">y</a>() ) * 
00533                                                   ( 1.0 - fCos ) - ( rkDir.<a class="code" href="classdg_1_1Vector.html#a4">z</a>() * fSin );
00534         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 0 ] [ 2 ] = ( rkDir.<a class="code" href="classdg_1_1Vector.html#a2">x</a>() * rkDir.<a class="code" href="classdg_1_1Vector.html#a4">z</a>() ) * 
00535                                                   ( 1.0 - fCos ) + ( rkDir.<a class="code" href="classdg_1_1Vector.html#a3">y</a>() * fSin );
00536 
00537         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 1 ] [ 0 ] = ( rkDir.<a class="code" href="classdg_1_1Vector.html#a3">y</a>() * rkDir.<a class="code" href="classdg_1_1Vector.html#a2">x</a>() ) * 
00538                                                   ( 1.0 - fCos ) + ( rkDir.<a class="code" href="classdg_1_1Vector.html#a4">z</a>() * fSin );
00539         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 1 ] [ 1 ] = ( rkDir.<a class="code" href="classdg_1_1Vector.html#a3">y</a>() * rkDir.<a class="code" href="classdg_1_1Vector.html#a3">y</a>() ) * 
00540                                                   ( 1.0 - fCos ) + fCos;
00541         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 1 ] [ 2 ] = ( rkDir.<a class="code" href="classdg_1_1Vector.html#a3">y</a>() * rkDir.<a class="code" href="classdg_1_1Vector.html#a4">z</a>() ) * 
00542                                                   ( 1.0 - fCos ) - ( rkDir.<a class="code" href="classdg_1_1Vector.html#a2">x</a>() * fSin );
00543 
00544         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 2 ] [ 0 ] = ( rkDir.<a class="code" href="classdg_1_1Vector.html#a4">z</a>() * rkDir.<a class="code" href="classdg_1_1Vector.html#a2">x</a>() ) * 
00545                                                   ( 1.0 - fCos ) - ( rkDir.<a class="code" href="classdg_1_1Vector.html#a3">y</a>() * fSin );
00546         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 2 ] [ 1 ] = ( rkDir.<a class="code" href="classdg_1_1Vector.html#a4">z</a>() * rkDir.<a class="code" href="classdg_1_1Vector.html#a3">y</a>() ) * 
00547                                                   ( 1.0 - fCos ) + ( rkDir.<a class="code" href="classdg_1_1Vector.html#a2">x</a>() * fSin );
00548         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 2 ] [ 2 ] = ( rkDir.<a class="code" href="classdg_1_1Vector.html#a4">z</a>() * rkDir.<a class="code" href="classdg_1_1Vector.html#a4">z</a>() ) * 
00549                                                   ( 1.0 - fCos ) + fCos;
00550 
00551         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 0 ] [ 3 ] = kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 1 ] [ 3 ] = kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 2 ] [ 3 ] = 0;
00552         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 3 ] [ 0 ] = kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 3 ] [ 1 ] = kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 3 ] [ 2 ] = 0;
00553         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 3 ] [ 3 ] = 1.0;
00554 
00555         <span class="keywordflow">return</span> kM;
00556 }
00557 <span class="comment">//******************************************************************************</span>
<a name="l00558"></a><a class="code" href="classdg_1_1Matrix.html#d6">00558</a> <a class="code" href="classdg_1_1Matrix.html">Matrix</a> Matrix::buildRotation( <a class="code" href="namespacedg.html#a28">Real</a> fA, <a class="code" href="namespacedg.html#a15">UInt</a> eAxis )
00559 {
00560         <span class="comment">//      dA *= M_PI_OVER_180;</span>
00561         fA = <a class="code" href="namespacedg.html#a88">Radians</a>( fA );
00562         <a class="code" href="namespacedg.html#a28">Real</a> fCos = <a class="code" href="namespacedg.html#a115">Cosine</a>( fA );
00563         <a class="code" href="namespacedg.html#a28">Real</a> fSin = <a class="code" href="namespacedg.html#a116">Sine</a>( fA );
00564 
00565         <a class="code" href="classdg_1_1Matrix.html">Matrix</a> kM( Matrix::IDENTITY );
00566 
00567         <span class="keywordflow">switch</span> ( eAxis )
00568         {
00570                 <span class="keywordflow">case</span>( 0 ) :
00571                         {
00572                                 kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 1 ] [ 1 ] = fCos;
00573                                 kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 1 ] [ 2 ] = -fSin;
00574                                 kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 2 ] [ 1 ] = fSin;
00575                                 kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 2 ] [ 2 ] = fCos;
00576                                 <span class="keywordflow">break</span>;
00577                         }
00579                 <span class="keywordflow">case</span>( 1 ) :
00580                         {
00581                                 kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 0 ] [ 0 ] = fCos;
00582                                 kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 0 ] [ 2 ] = fSin;
00583                                 kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 2 ] [ 0 ] = -fSin;
00584                                 kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 2 ] [ 2 ] = fCos;
00585                                 <span class="keywordflow">break</span>;
00586                         }
00588                 <span class="keywordflow">case</span>( 2 ) :
00589                         {
00590                                 kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 0 ] [ 0 ] = fCos;
00591                                 kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 0 ] [ 1 ] = -fSin;
00592                                 kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 1 ] [ 0 ] = fSin;
00593                                 kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 1 ] [ 1 ] = fCos;
00594                                 <span class="keywordflow">break</span>;
00595                         }
00596         };
00597 
00598         <span class="keywordflow">return</span> kM;
00599 }
00600 <span class="comment">/*</span>
00601 <span class="comment">//------------------------------------------------------------------------------</span>
00602 <span class="comment">Matrix Matrix::buildPerspective( const Frustum &amp; rkF )</span>
00603 <span class="comment">{</span>
00604 <span class="comment">        Matrix kM;</span>
00605 <span class="comment"></span>
00606 <span class="comment">        kM.m_afV[ 0 ] [ 0 ] = ( 2.0f * rkF.near() ) / ( rkF.right() - rkF.left() );</span>
00607 <span class="comment">        kM.m_afV[ 0 ] [ 1 ] = 0.0f;</span>
00608 <span class="comment">        kM.m_afV[ 0 ] [ 2 ] = ( rkF.right() + rkF.left() ) / ( rkF.right() - rkF.left() );</span>
00609 <span class="comment">        kM.m_afV[ 0 ] [ 3 ] = 0.0f;</span>
00610 <span class="comment"></span>
00611 <span class="comment">        kM.m_afV[ 1 ] [ 0 ] = 0.0f;</span>
00612 <span class="comment">        kM.m_afV[ 1 ] [ 1 ] = ( 2.0f * rkF.near() ) / ( rkF.top() - rkF.bottom() );</span>
00613 <span class="comment">        kM.m_afV[ 1 ] [ 2 ] = ( rkF.top() + rkF.bottom() ) / ( rkF.top() - rkF.bottom() );</span>
00614 <span class="comment">        kM.m_afV[ 1 ] [ 3 ] = 0.0f;</span>
00615 <span class="comment"></span>
00616 <span class="comment">        kM.m_afV[ 2 ] [ 0 ] = 0.0f;</span>
00617 <span class="comment">        kM.m_afV[ 2 ] [ 1 ] = 0.0f;</span>
00618 <span class="comment">        kM.m_afV[ 2 ] [ 2 ] = -( rkF.far() + rkF.near() ) / ( rkF.far() - rkF.near() );</span>
00619 <span class="comment">        kM.m_afV[ 2 ] [ 3 ] = -( 2.0f * rkF.far() * rkF.near() ) / ( rkF.far() - rkF.near() );</span>
00620 <span class="comment"></span>
00621 <span class="comment">        kM.m_afV[ 3 ] [ 0 ] = 0.0f;</span>
00622 <span class="comment">        kM.m_afV[ 3 ] [ 1 ] = 0.0f;</span>
00623 <span class="comment">        kM.m_afV[ 3 ] [ 2 ] = 0.0f;</span>
00624 <span class="comment">        kM.m_afV[ 3 ] [ 3 ] = 1.0f;</span>
00625 <span class="comment"></span>
00626 <span class="comment">        return kM;</span>
00627 <span class="comment">}</span>
00628 <span class="comment">//------------------------------------------------------------------------------</span>
00629 <span class="comment">Matrix Matrix::buildOrthographic( const Frustum &amp; rkF )</span>
00630 <span class="comment">{</span>
00631 <span class="comment">        Matrix kM;</span>
00632 <span class="comment"></span>
00633 <span class="comment">        kM.m_afV[ 0 ] [ 0 ] = 2.0f / ( rkF.right() - rkF.left() );</span>
00634 <span class="comment">        kM.m_afV[ 0 ] [ 1 ] = 0.0f;</span>
00635 <span class="comment">        kM.m_afV[ 0 ] [ 2 ] = 0.0f;</span>
00636 <span class="comment">        kM.m_afV[ 0 ] [ 3 ] = -( rkF.right() + rkF.left() ) / ( rkF.right() - rkF.left() );</span>
00637 <span class="comment"></span>
00638 <span class="comment">        kM.m_afV[ 1 ] [ 0 ] = 0.0f;</span>
00639 <span class="comment">        kM.m_afV[ 1 ] [ 1 ] = 2.0f / ( rkF.top() - rkF.bottom() );</span>
00640 <span class="comment">        kM.m_afV[ 1 ] [ 2 ] = 0.0f;</span>
00641 <span class="comment">        kM.m_afV[ 1 ] [ 3 ] = -( rkF.top() + rkF.bottom() ) / ( rkF.top() - rkF.bottom() );</span>
00642 <span class="comment"></span>
00643 <span class="comment">        kM.m_afV[ 2 ] [ 0 ] = 0.0f;</span>
00644 <span class="comment">        kM.m_afV[ 2 ] [ 1 ] = 0.0f;</span>
00645 <span class="comment">        kM.m_afV[ 2 ] [ 2 ] = -2.0f / ( rkF.far() - rkF.near() );</span>
00646 <span class="comment">        kM.m_afV[ 2 ] [ 3 ] = -( rkF.far() + rkF.near() ) / ( rkF.far() - rkF.near() );</span>
00647 <span class="comment"></span>
00648 <span class="comment">        kM.m_afV[ 3 ] [ 0 ] = 0.0f;</span>
00649 <span class="comment">        kM.m_afV[ 3 ] [ 1 ] = 0.0f;</span>
00650 <span class="comment">        kM.m_afV[ 3 ] [ 2 ] = 0.0f;</span>
00651 <span class="comment">        kM.m_afV[ 3 ] [ 3 ] = 1.0f;</span>
00652 <span class="comment"></span>
00653 <span class="comment">        return kM;</span>
00654 <span class="comment">}</span>
00655 <span class="comment">//------------------------------------------------------------------------------</span>
00656 <span class="comment">Matrix Matrix::buildInversePerspective( const Frustum &amp; rkF )</span>
00657 <span class="comment">{</span>
00658 <span class="comment">        Matrix kM;</span>
00659 <span class="comment"></span>
00660 <span class="comment">        kM.m_afV[ 0 ] [ 0 ] = ( rkF.right() - rkF.left() ) / ( 2.0f * rkF.near() );</span>
00661 <span class="comment">        kM.m_afV[ 0 ] [ 1 ] = 0.0f;</span>
00662 <span class="comment">        kM.m_afV[ 0 ] [ 2 ] = 0.0f;</span>
00663 <span class="comment">        kM.m_afV[ 0 ] [ 3 ] = ( rkF.right() + rkF.left() ) / ( 2.0f * rkF.near() );</span>
00664 <span class="comment"></span>
00665 <span class="comment">        kM.m_afV[ 1 ] [ 0 ] = 0.0f;</span>
00666 <span class="comment">        kM.m_afV[ 1 ] [ 1 ] = ( rkF.top() - rkF.bottom() ) / ( 2.0f * rkF.near() );</span>
00667 <span class="comment">        kM.m_afV[ 1 ] [ 2 ] = 0.0f;</span>
00668 <span class="comment">        kM.m_afV[ 1 ] [ 3 ] = ( rkF.top() + rkF.bottom() ) / ( 2.0f * rkF.near() );</span>
00669 <span class="comment"></span>
00670 <span class="comment">        kM.m_afV[ 2 ] [ 0 ] = 0.0f;</span>
00671 <span class="comment">        kM.m_afV[ 2 ] [ 1 ] = 0.0f;</span>
00672 <span class="comment">        kM.m_afV[ 2 ] [ 2 ] = 0.0f;</span>
00673 <span class="comment">        kM.m_afV[ 2 ] [ 3 ] = 1.0f;</span>
00674 <span class="comment"></span>
00675 <span class="comment">        kM.m_afV[ 3 ] [ 0 ] = 0.0f;</span>
00676 <span class="comment">        kM.m_afV[ 3 ] [ 1 ] = 0.0f;</span>
00677 <span class="comment">        kM.m_afV[ 3 ] [ 2 ] = -( rkF.far() - rkF.near() ) / ( 2.0f * rkF.far() * rkF.near() );</span>
00678 <span class="comment">        kM.m_afV[ 3 ] [ 3 ] = ( rkF.far() + rkF.near() ) / ( 2.0f * rkF.far() * rkF.near() );</span>
00679 <span class="comment"></span>
00680 <span class="comment">        return kM;</span>
00681 <span class="comment">}</span>
00682 <span class="comment">//------------------------------------------------------------------------------</span>
00683 <span class="comment">*/</span>
<a name="l00684"></a><a class="code" href="classdg_1_1Matrix.html#d9">00684</a> <a class="code" href="classdg_1_1Matrix.html">Matrix</a> Matrix::fromAxisToAngle( <span class="keyword">const</span> <a class="code" href="classdg_1_1Vector.html">Vector</a> &amp; rkAxis, <span class="keyword">const</span> <a class="code" href="namespacedg.html#a28">Real</a> fAngle )
00685 {
00686         <a class="code" href="namespacedg.html#a28">Real</a> fRadians = <a class="code" href="namespacedg.html#a88">Radians</a>( fAngle );
00687 
00688         <a class="code" href="namespacedg.html#a28">Real</a> fCos = <a class="code" href="namespacedg.html#a115">Cosine</a>( fRadians );
00689         <a class="code" href="namespacedg.html#a28">Real</a> fSin = <a class="code" href="namespacedg.html#a116">Sine</a>( fRadians );
00690         <a class="code" href="namespacedg.html#a28">Real</a> fOneMinusCos = 1.0f - fCos;
00691 
00692         <a class="code" href="namespacedg.html#a28">Real</a> fX2 = <a class="code" href="namespacedg.html#a100">Sqr</a>( rkAxis.<a class="code" href="classdg_1_1Vector.html#a2">x</a>() );
00693         <a class="code" href="namespacedg.html#a28">Real</a> fY2 = <a class="code" href="namespacedg.html#a100">Sqr</a>( rkAxis.<a class="code" href="classdg_1_1Vector.html#a3">y</a>() );
00694         <a class="code" href="namespacedg.html#a28">Real</a> fZ2 = <a class="code" href="namespacedg.html#a100">Sqr</a>( rkAxis.<a class="code" href="classdg_1_1Vector.html#a4">z</a>() );
00695 
00696         <a class="code" href="namespacedg.html#a28">Real</a> fXYM = rkAxis.<a class="code" href="classdg_1_1Vector.html#a2">x</a>() * rkAxis.<a class="code" href="classdg_1_1Vector.html#a3">y</a>() * fOneMinusCos;
00697         <a class="code" href="namespacedg.html#a28">Real</a> fXZM = rkAxis.<a class="code" href="classdg_1_1Vector.html#a2">x</a>() * rkAxis.<a class="code" href="classdg_1_1Vector.html#a4">z</a>() * fOneMinusCos;
00698         <a class="code" href="namespacedg.html#a28">Real</a> fYZM = rkAxis.<a class="code" href="classdg_1_1Vector.html#a3">y</a>() * rkAxis.<a class="code" href="classdg_1_1Vector.html#a4">z</a>() * fOneMinusCos;
00699 
00700         <a class="code" href="namespacedg.html#a28">Real</a> fXSin = rkAxis.<a class="code" href="classdg_1_1Vector.html#a2">x</a>() * fSin;
00701         <a class="code" href="namespacedg.html#a28">Real</a> fYSin = rkAxis.<a class="code" href="classdg_1_1Vector.html#a3">y</a>() * fSin;
00702         <a class="code" href="namespacedg.html#a28">Real</a> fZSin = rkAxis.<a class="code" href="classdg_1_1Vector.html#a4">z</a>() * fSin;
00703 
00704         <a class="code" href="classdg_1_1Matrix.html">Matrix</a> kM;
00705         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 0 ] [ 0 ] = fX2 * fOneMinusCos + fCos;
00706         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 1 ] [ 0 ] = fXYM - fZSin;
00707         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 2 ] [ 0 ] = fXZM + fYSin;
00708         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 3 ] [ 0 ] = 0.0f;
00709 
00710         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 0 ] [ 1 ] = fXYM + fZSin;
00711         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 1 ] [ 1 ] = fY2 * fOneMinusCos + fCos;
00712         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 2 ] [ 1 ] = fYZM - fXSin;
00713         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 3 ] [ 1 ] = 0.0f;
00714 
00715         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 0 ] [ 2 ] = fXZM - fYSin;
00716         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 1 ] [ 2 ] = fYZM + fXSin;
00717         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 2 ] [ 2 ] = fZ2 * fOneMinusCos + fCos;
00718         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 3 ] [ 2 ] = 0.0f;
00719 
00720         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 3 ] [ 0 ] = 0.0f;
00721         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 3 ] [ 1 ] = 0.0f;
00722         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 3 ] [ 2 ] = 0.0f;
00723         kM.<a class="code" href="classdg_1_1Matrix.html#o0">m_afV</a>[ 3 ] [ 3 ] = 1.0f;
00724 
00725         <span class="keywordflow">return</span> kM;
00726 }
00727 <span class="comment">//------------------------------------------------------------------------------</span>
00728 
00729 <span class="comment">// #############################################################################</span>
00730 <span class="comment">// constant definitions</span>
00731 <span class="comment">// #############################################################################</span>
00732 
00733 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00734"></a><a class="code" href="classdg_1_1Matrix.html#p0">00734</a> <span class="keyword">const</span> <a class="code" href="classdg_1_1Matrix.html">Matrix</a> Matrix::ZERO =
00735     <a class="code" href="classdg_1_1Matrix.html">Matrix</a>(
00736         0.0f, 0.0f, 0.0f, 0.0f,
00737         0.0f, 0.0f, 0.0f, 0.0f,
00738         0.0f, 0.0f, 0.0f, 0.0f,
00739         0.0f, 0.0f, 0.0f, 0.0f
00740     );
00741 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00742"></a><a class="code" href="classdg_1_1Matrix.html#p1">00742</a> <span class="keyword">const</span> Matrix Matrix::IDENTITY =
00743     Matrix(
00744         1.0f, 0.0f, 0.0f, 0.0f,
00745         0.0f, 1.0f, 0.0f, 0.0f,
00746         0.0f, 0.0f, 1.0f, 0.0f,
00747         0.0f, 0.0f, 0.0f, 1.0f
00748     );
00749 <span class="comment">//------------------------------------------------------------------------------</span>
</pre></div>		<div class="footer" width="100%">
		<hr>
			<a href="http://lyon-smith.org/">&copy; Derek Gerstmann - NCCA - Bournemouth University - 2004</a>
		</div>
		<br>
	</body>
</html>
